<!-- #virtru-sdk-for-c 3212
    #virtru-sdk-for-nodejs 1292
  #virtru-sdk-for-python 2322
#virtru-sdk-for-client-side-javascript-->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width:1600px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }

    .main_wrapper {
    display: flex;
    flex-flow: row nowrap;
    justify-content: space-between;
      max-width: 1500px;margin: auto;padding: 35px 0;}

      .sidebar_nav {width: 25%;flex: 0 1 25%;}
      .sidebar_nav .inner_wrapper ul ul {margin-top: 10px;}

      .sidebar_nav .inner_wrapper>ul>li {font-weight: 800;}

      .inner_wrapper ul ul li {font-weight: 400;}
      .main_content {width: 75%;flex: 0 1 75%;padding: 0 25px 0;}
      .sidebar_nav .inner_wrapper {    
         padding: 15px;
         background: #f5f5f5;}
      h1#overview {margin: 0;}

      .inner_wrapper ul li {
         font-family: 'Open Sans', sans-serif;
         font-size:16px;
         margin-bottom:10px;
}
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
        font-family: 'Raleway', sans-serif;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
        font-family: 'Raleway', sans-serif;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
      font-family: 'Raleway', sans-serif;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600&family=Raleway:wght@300;400&display=swap" rel="stylesheet">
</head>
<body>

   <div class="main_wrapper">
      <div class="sidebar_nav">
         <div class="inner_wrapper">
            <ul>
               <li>Supported SDKs</li>
               <li><a href="#js_sdk_wrapper">JavaScript</a>
           <ul>
               <li><a href="#virtru-sdk-for-client-side-javascript">Quick Start: Client-Side JavaScript</a></li>
               <li><a href="#authentication">Client-Side JS Authentication</a></li>
               <li><a href="#encryption-basics">Client-Side JS Encryption</a></li>
               <li><a href="#decrypt">Client-Side JS Decryption</a></li>
               <li><a href="#access-control">Client-Side JS Access Controls</a></li>
           </ul>
           </li>
               <li><a href="#nodejs_sdk_wrapper">Node.js</a>
           <ul>
               <li><a href="#quick-start-1">Quick Start: Node.js</a></li>
               <li><a href="#authentication-1">Node.js Authentication</a></li>
               <li><a href="#encrypt-1">Node.js Encryption</a></li>
               <li><a href="#decrypt-1">Node.js Decryption</a></li>
               <li><a href="#access-control-1">Node.js Access Controls</a></li>
           </ul>
           </li>
               <li><a href="#python_sdk_wrapper">Python</a>
           <ul>
               <li><a href="#quick-start-2">Quick Start: Python</a></li>
               <li><a href="#authentication-2">Python Authentication</a></li>
               <li><a href="#encrypt-2">Python Encryption</a></li>
               <li><a href="#decrypt-2">Python Decryption</a></li>
               <li><a href="#access-control-2">Python Access Controls</a></li>
           </ul>
           </li>
               <li><a href="#cplusplus_sdk_wrapper">C++</a>
           <ul>
            <li><a href="quick-start-3">Quick Start: C++</a></li>
               <li> <a href="#authentication-3"> C++ Authentication</a></li>
               <li><a href="#encrypt-4">C++ Encryption</a></li>
               <li><a href="#decrypt-3">C++ Decryption</a></li>
               <li><a href="#access-control-3">C++ Access Controls</a></li>
           </ul>
           </li>
               <li>Sample Apps</li>
               <li>Architecture</li>
               <li>Glossary</li>
               <li>FAQs</li>
               <li>Community</li>
               <li>Code of Conduct</li>
               <li>Responsible Disclosure</li>
               <li>About Virtru</li>
           </ul>
      </div>
   </div>
   <div class="main_content">
  <div id="intro_wrapper" class="intro_wrapper">
     <h1 id="overview">Overview</h1>
      <h2 id="supported-sdks">Supported SDKs</h2>
      <p>Protect, track &amp; control data with the Virtru SDK in the following languages:</p>
      </div>
      <div id="js_sdk_wrapper" class="sdk_wrapper">
      <h3 id="virtru-sdk-for-client-side-javascript">Virtru SDK for Client-side JavaScript</h3>
      <blockquote>
      <p><a href="https://docs.developer.virtru.com/js/2.1.0/">JavaScript SDK Documentation</a></p>
      </blockquote>
      <h4 id="quick-start">Quick Start</h4>
      <p>You’re Alice and you have sensitive data to protect. (Don’t we all?) Let’s see the fastest way to protect it client-side with the Virtru JavaScript SDK:</p>
      <h5 id="prerequisites">Prerequisites</h5>
      <blockquote>
      <p>Note: These steps assume a *nix style command line, as available in macOS and linux</p>
      </blockquote>
      <h5 id="0-run-a-basic-server">0. Run a basic server</h5>
      <p>Because the Virtru JavaScript SDK respects <strong>strong security practices like CORS</strong>, you’ll need to run a basic web server for your first app. Running JavaScript in a local HTML file will not
      work.</p>
<!--- SNIPPET step-0/index.html --->

<div class="sourceCode" id="cb1">
      <pre class="sourceCode html">
        <code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
          <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
          <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;title&gt;</span>Boilerplate - Virtru SDK for JavaScript - Sample Application<span class="kw">&lt;/title&gt;</span></span>
          <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/2.1.0/virtru-sdk.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
          <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/head&gt;</span></span>
          <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;body&gt;</span></span>
          <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span></span>
          <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&quot;Virtru.Version: &quot;</span> <span class="op">+</span> Virtru<span class="op">.</span><span class="at">Version</span>)<span class="op">;</span></span>
          <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/script&gt;</span></span>
          <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/body&gt;</span></span>
          <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span>
        </code>
      </pre>
  </div>
  
  <p>Let’s use Parcel for packaging, which also provides a local web server with a self-signed HTTPS certificate for testing.</p>
  <pre class="shell"><code>npm install -g parcel parcel --https index.html</code></pre>
  <p>Open your browser of choice to https://localhost:1234, Parcel's
  default URL.</p>
  <h5 id="1-get-an-identity">1. Get an identity</h5>
  <p>So Alice, who should own your sensitive data? You, obviously!</p>
  <p>Authenticate to associate your email address (e.g. <a
  href="mailto:alice@example.com">alice@example.com</a>) with any data you protect. <strong>You cannot protect data without authenticating.</strong> If the Virtru Platform doesn’t know who’s protecting data, 
  no one would be able to access it later (when they’re also asked to authenticate).</p>
  <p>The fastest way to authenticate is with Virtru’s auth widget.</p>
  <!--- SNIPPET step-1/index.html --->

<div class="sourceCode" id="cb3">
    <pre class="sourceCode html">
      <code class="sourceCode html"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
        <span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
        <span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;title&gt;</span>Auth - Virtru SDK for JavaScript - Sample Application<span class="kw">&lt;/title&gt;</span></span>
        <span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;link</span></span>
        <span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ot">      href=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.css&quot;</span></span>
        <span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ot">      rel=</span><span class="st">&quot;stylesheet&quot;</span></span>
        <span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">/&gt;</span></span>
        <span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/2.1.0/virtru-sdk.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/head&gt;</span></span>
        <span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;body&gt;</span></span>
        <span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
        <span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;./main.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/body&gt;</span></span>
        <span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span>
      </code>
    </pre>
  </div>
  <!--- SNIPPET step-1/main.js --->

<div class="sourceCode" id="cb4">
    
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
<span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
        <span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alert</span>(<span class="vs">`Hello, </span><span class="sc">${</span>email<span class="sc">}</span><span class="vs">. You&#39;re ready to protect with Virtru!`</span>)<span class="op">;</span></span>
        <span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up Virtru auth widget</span></span>
        <span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
      </code>
    </pre>
  </div>
  
<h5 id="2-ask-for-sensitive-data">2. Ask for sensitive data</h5>
  <p>Now that we know who will own things, why don’t you enter your first
  piece of sensitive data? For simplicity’s sake, let’s use a quick string.</p>
  <!--- SNIPPET step-2/main.js --->

<div class="sourceCode" id="cb5">
    
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
        <span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
        <span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Ask for sensitive data</span></span>
        <span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yourString <span class="op">=</span> <span class="fu">prompt</span>(<span class="st">&quot;Type something to encrypt: &quot;</span><span class="op">,</span> <span class="st">&quot;sensitive data...&quot;</span>)<span class="op">;</span></span>
        <span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up Virtru auth widget</span></span>
        <span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
      </code>
    </pre>
  </div>
  
<h5 id="3-protect-the-sensitive-data">3. Protect the sensitive data</h5>
  <p>To protect your sensitive data, we’ll need a Virtru client. We’ll
  associate anything you encrypt with your email (from the auth widget):</p>
<div class="sourceCode" id="cb6">
    
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
        <span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      </code>
    </pre>
  </div>

  <p>Next, decide your encryption options. For now, it’s the string
  containing your sensitive data. In the future, this could include who
  else should have access and under what conditions.</p>
  <!--- SNIPPET step-3/main.js 9 11 --->

<div class="sourceCode" id="cb7">
    
    <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withStringSource</span>(plainText)</span>
      <span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
    </code>
    </pre>
</div>
  <p>Finally, since the encrypt call is asynchronous, we’ll wait for it to
  finish:</p>
  <!--- SNIPPET step-3/main.js 12 13 --->

<div class="sourceCode" id="cb8">
    
    <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> ciphertextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="cf">await</span> ciphertextStream<span class="op">.</span><span class="fu">toString</span>())<span class="op">;</span></span>
    </code>
    </pre>
</div>
  <p>How do we know it worked? <strong>We should see ciphertext</strong>
  when we examine what got returned from encrypt.</p>
  <!--- SNIPPET step-3/main.js --->

<div class="sourceCode" id="cb9">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
        <span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
        <span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Ask for sensitive data</span></span>
        <span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plainText <span class="op">=</span> <span class="fu">prompt</span>(<span class="st">&quot;Type something to encrypt: &quot;</span><span class="op">,</span> <span class="st">&quot;sensitive data...&quot;</span>)<span class="op">;</span></span>
        <span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Client will enable all other work</span></span>
        <span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
        <span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Protect the sensitive data</span></span>
        <span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
        <span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withStringSource</span>(plainText)</span>
        <span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ciphertextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
        <span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="cf">await</span> ciphertextStream<span class="op">.</span><span class="fu">toString</span>())<span class="op">;</span></span>
        <span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up Virtru auth widget</span></span>
        <span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
      </code>
  </pre>
</div>

  <h5 id="4-access-the-sensitive-data-now">4. Access the sensitive data
  now</h5>
  <p>Now, let’s say you need to see your sensitive data again immediately.
  Well, you’re still authenticated as <a
  href="mailto:alice@example.com">alice@example.com</a> so you can decrypt
  the ciphertext:</p>
  <!--- SNIPPET step-4/main.js --->

<div class="sourceCode" id="cb10">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Ask for sensitive data</span></span>
      <span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plainText <span class="op">=</span> <span class="fu">prompt</span>(<span class="st">&quot;Type something to encrypt: &quot;</span><span class="op">,</span> <span class="st">&quot;sensitive data...&quot;</span>)<span class="op">;</span></span>
      <span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Client will enable all other work</span></span>
      <span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Protect the sensitive data</span></span>
      <span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">async</span> <span class="kw">function</span> <span class="fu">encryptToString</span>(plain) {</span>
      <span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withStringSource</span>(plain)</span>
      <span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withDisplayFilename</span>(<span class="st">&quot;sensitive.txt&quot;</span>)</span>
      <span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ciphertextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ciphertext <span class="op">=</span> <span class="cf">await</span> ciphertextStream<span class="op">.</span><span class="fu">toString</span>()<span class="op">;</span></span>
      <span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ciphertext<span class="op">;</span></span>
      <span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  }</span>
      <span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> ciphertext <span class="op">=</span> <span class="cf">await</span> <span class="fu">encryptToString</span>(plainText)<span class="op">;</span></span>
      <span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Access the sensitive data now</span></span>
      <span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">async</span> <span class="kw">function</span> <span class="fu">decryptFromString</span>(ciphertext) {</span>
      <span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withStringSource</span>(ciphertext)</span>
      <span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> plaintextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">decrypt</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> plaintext <span class="op">=</span> <span class="cf">await</span> plaintextStream<span class="op">.</span><span class="fu">toString</span>()<span class="op">;</span></span>
      <span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> plaintext<span class="op">;</span></span>
      <span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  }</span>
      <span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> decrypted <span class="op">=</span> <span class="cf">await</span> <span class="fu">decryptFromString</span>(ciphertext)<span class="op">;</span></span>
      <span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Validate that the original value and its decrypted version are the same.</span></span>
      <span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (plainText <span class="op">===</span> decrypted) {</span>
      <span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;The decrypted string matches your original one!&quot;</span>)<span class="op">;</span></span>
      <span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
      <span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alert</span>(</span>
      <span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>      <span class="vs">`ERROR: Output, [</span><span class="sc">${</span>decrypted<span class="sc">}</span><span class="vs">], does not match input, [</span><span class="sc">${</span>plainText<span class="sc">}</span><span class="vs">]`</span></span>
      <span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
      <span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  }</span>
      <span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up Virtru auth widget</span></span>
      <span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
</code>
  </pre>
</div>
  <p>But what if you close this tab or stop your web server? We need to
  remember the sensitive data we protected to access it later.</p>
  <h5 id="5-access-the-sensitive-data-again-later">5. Access the sensitive
  data again later</h5>
  <p>The Virtru SDK lets you <strong>save your ciphertext as an HTML
  file</strong> you can open again later. This is also asynchronous.</p>
  <!--- SNIPPET step-5/main.js --->

<div class="sourceCode" id="cb11">
    <pre class="sourceCode javascript">
        <code class="sourceCode javascript">
          <span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
          <span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Ask for sensitive data</span></span>
          <span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plainText <span class="op">=</span> <span class="fu">prompt</span>(<span class="st">&quot;Type something to encrypt: &quot;</span><span class="op">,</span> <span class="st">&quot;sensitive data...&quot;</span>)<span class="op">;</span></span>
          <span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Client will enable all other work</span></span>
          <span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
          <span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Protect the sensitive data</span></span>
          <span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">async</span> <span class="kw">function</span> <span class="fu">encryptToFile</span>(text<span class="op">,</span> encryptedFilename) {</span>
          <span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> displayFileName <span class="op">=</span> encryptedFilename<span class="op">.</span><span class="fu">replace</span>(<span class="st">&quot;.tdf.html&quot;</span><span class="op">,</span> <span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
          <span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
          <span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withStringSource</span>(text)</span>
          <span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withDisplayFilename</span>(displayFileName)</span>
          <span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ciphertextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
          <span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> ciphertextStream<span class="op">.</span><span class="fu">toFile</span>(encryptedFilename)<span class="op">;</span></span>
          <span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Access the sensitive data again later</span></span>
          <span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> encryptedFilename <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> <span class="fu">encryptToFile</span>(plainText<span class="op">,</span> encryptedFilename)<span class="op">;</span></span>
          <span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up Virtru auth widget</span></span>
          <span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
        </code>
    </pre>
</div>
  <h5 id="6-access-the-sensitive-data-anywhere">6. Access the sensitive
  data anywhere</h5>
  <p>If you inspect the generated HTML file, you still won’t find your sensitive data. It stays protected. You can send that HTML file to another machine or anywhere you want. Only you will be able to access
  it. But how do you do that outside of this code?</p>
  <p>We could build a whole set of functionality to authenticate, decrypt,
  and render files. Or we could <strong>use Virtru’s Secure Reader</strong>, which is built to do exactly that for thousands of security-conscious users every day. In fact, if you open that HTML file from the last step, it will redirect you to Secure Reader.</p>
  <p>Secure Reader will ask you to authenticate. (You’re still Alice,
  aren’t you?)</p>
  <p><img src=".screenshots/auth.png"
  alt="Authenticating with Virtru Secure Reader" /></p>
  <p>And if you authenticate with the same email address you used to
  create the HTML file, you should be able to view it in Secure
  Reader:</p>
  <p><img src=".screenshots/decrypt.png"
  alt="Decrypting with Virtru Secure Reader" /></p>
  <p>Congrats Alice! <strong>Your sensitive data is safe wherever it
  goes</strong>.</p>
  
  <h4 id="authentication">Authentication</h4>
  <p>Security starts with identity. You claim you’re Alice, but the Virtru
  SDK doesn’t know that. We can’t protect or access data without an
  identity that’s responsible for protecting or accessing that data.
  Otherwise, no one (or anyone) would be able to do whatever they want
  with your data. But we all have sensitive data to protect.</p>
  <p>So how do you prove your identity to the Virtru SDK? We’re glad you
  asked, “Alice…”</p>
  <p>Here are your options in web browsers and mobile apps:</p>
  <ol type="1">
  <li>Drop in the Auth Widget to make SDK calls and show UI</li>
  <li>Send and confirm email codes via SDK calls and custom UI</li>
  <li>Use Federated Authentication via SDK calls and custom UI</li>
  </ol>
  <p>These options are <em>mutually exclusive</em> from server-side
  Node.js Authentication.</p>
  <h5 id="auth-widget">Auth Widget</h5>
  <p>The Virtru auth widget is the fastest way to add authentication. We
  recommend it if you’re getting started with the Client-side JavaScript
  SDK. It includes the other client-side authentication options—email
  codes and federated authentication.</p>
  <p>Virtru provides an auth widget with all client-side authentication
  calls and standard UI from Virtru’s products. You only have to specify
  an HTML element to render the widget and a callback for whatever needs
  to happen after users authenticate.</p>
  <!--- SNIPPET widget.html --->

<div class="sourceCode" id="cb12">
    <pre class="sourceCode html">
      <code class="sourceCode html"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
          <span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
          <span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;title&gt;</span>Auth - Virtru SDK for JavaScript - Sample Application<span class="kw">&lt;/title&gt;</span></span>
          <span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;link</span></span>
          <span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ot">      href=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.css&quot;</span></span>
          <span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="ot">      rel=</span><span class="st">&quot;stylesheet&quot;</span></span>
          <span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">/&gt;</span></span>
          <span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
          <span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/2.1.0/virtru-sdk.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
          <span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/head&gt;</span></span>
          <span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;body&gt;</span></span>
          <span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
          <span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script&gt;</span></span>
          <span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      <span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
          <span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">alert</span>(<span class="vs">`Hello, </span><span class="sc">${</span>email<span class="sc">}</span><span class="vs">. You&#39;re ready to protect with Virtru!`</span>)<span class="op">;</span></span>
          <span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>      }</span>
          <span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Set up Virtru auth widget</span></span>
          <span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;virtru-auth-widget-mount&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
          <span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/script&gt;</span></span>
          <span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/body&gt;</span></span>
          <span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span>
      </code>
  </pre>
</div>
  
<h5 id="email-codes">Email Codes</h5>
  <p>Email codes are alphanumeric codes that prove your identity for a
  short session. Codes expire in 15 minutes.</p>
  <p>The Virtru SDK lets you send email codes to <a
  href="mailto:alice@example.com">alice@example.com</a>:</p>

<div class="sourceCode" id="cb13">
    
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
      <span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="at">Auth</span><span class="op">.</span><span class="fu">sendCodeToEmail</span>({ <span class="dt">email</span><span class="op">:</span> <span class="st">&quot;alice@example.com&quot;</span> })<span class="op">;</span></span>
    </code>
    </pre>
</div>
  <p>You would then check <a
  href="mailto:alice@example.com">alice@example.com</a>’s inbox and copy
  the code from the Virtru email. And submit that code back to the
  SDK:</p>
<div class="sourceCode" id="cb14">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
        <span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="at">Auth</span><span class="op">.</span><span class="fu">activateEmailCode</span>({</span>
        <span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">email</span><span class="op">:</span> <span class="st">&quot;alice@example.com&quot;</span><span class="op">,</span></span>
        <span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">code</span><span class="op">:</span> <span class="st">&quot;V-12345678&quot;</span></span>
        <span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
      </code>
  </pre>
</div>

  <p>If the code submitted matches the code sent, the Virtru JavaScript
  SDK remembers your authentication status. You can confirm that by
  checking:</p>
<div class="sourceCode" id="cb15">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="at">Auth</span><span class="op">.</span><span class="fu">isLoggedIn</span>()<span class="op">;</span></span>
    </code>
  </pre>
</div>

  <h5 id="federated-authentication">Federated Authentication</h5>
  <p>Federated Authentication is a good option for users to authenticate
  faster with OAuth providers (e.g. Google, Office 365, or Outlook). <a
  href="https://developer.virtru.com/docs/how-to-add-your-site-to-virtru-whitelist"><strong>You’ll
  need to whitelist your domain for this option.</strong></a> You can test
  this option locally with the <code>local.virtru.com</code> domain like
  so:</p>
  <pre class="shell">
    <code>echo &quot;127.0.0.1       local.virtru.com  # Local Virtru SDK testing&quot; &gt;&gt; /etc/hosts</code></pre>
      <p>Once your domain is white listed, you can call methods like
    <code>loginWithGoogle</code> to let Google handle the
  authentication:</p>
<div class="sourceCode" id="cb17">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="at">Auth</span><span class="op">.</span><span class="fu">loginWithGoogle</span>({ <span class="dt">email</span><span class="op">:</span> <span class="st">&quot;alice@example.com&quot;</span> })<span class="op">;</span></span>
    </code>
  </pre>
</div>
  <p>This call goes to the Virtru Platform. If your domain is not
  whitelisted, this call will fail. If your domain is white listed, it
  will ask you to log in with Google.</p>
  <p>Whichever email address you authenticate with Google (e.g. <a
  href="mailto:alice@example.com">alice@example.com</a> or <a
  href="mailto:alice@somewhere.org">alice@somewhere.org</a>) will be sent
  back to the Virtru Platform and authenticated for future Virtru
  JavaScript SDK calls. The Platform will redirect you back to your
  app.</p>
  <h5 id="checking-authentication-status">Checking authentication
  status</h5>
  <p>How can you check if a user authenticated? This should work for any
  of the authentication methods above.</p>
<div class="sourceCode" id="cb18">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
        <span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="at">Auth</span><span class="op">.</span><span class="fu">isLoggedIn</span>()<span class="op">;</span></span>
      </code>
    </pre>
</div>
  
<h2 id="encrypt">Encrypt</h2>
  <p>Now that the Virtru SDK knows you’re Alice, you can protect your
  first piece of data.</p>
  <h3 id="encryption-basics">Encryption Basics</h3>
  <p>Before calling encrypt, you need to specify a few simple
  parameters.</p>
  <p>You don’t need to include your email address when encrypting. You
  will already have access to anything you encrypt because you
  authenticated. But if you want anyone else to have access (like another
  one of your emails, <code>alice@nowhere.com</code>), you could include
  them here:</p>
  <!--- SNIPPET protect-html.js 12 22 --->

<div class="sourceCode" id="cb19">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">// specify access controls</span></span>
      <span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
      <span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
      <span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">// protect &amp; output</span></span>
      <span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withStringSource</span>(unprotectedString)</span>
      <span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
      <span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
      <span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
    </code>
  </pre>
</div>
  <p>Call encrypt and check out the resulting file:</p>
  <!--- SNIPPET protect-html.js 23 28 --->

<div class="sourceCode" id="cb20">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
      <span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
      <span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> protectedStream</span>
      <span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
      <span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
    </code>
  </pre>
</div>
  <p>Here's the complete source code:</p>
  <!--- SNIPPET protect-html.js --->

<div class="sourceCode" id="cb21">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Encryption example - HTML format</span></span>
      <span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protect</span>(unprotectedString) {</span>
      <span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
      <span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// specify access controls</span></span>
      <span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
      <span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
      <span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// protect &amp; output</span></span>
      <span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withStringSource</span>(unprotectedString)</span>
      <span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
      <span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
      <span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
      <span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
      <span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream</span>
      <span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
      <span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
      <span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  
<p>Now, your sensitive data is safe. Keep reading to see how or access
  your data by decrypting.</p>
  <hr />
  <h5 id="encryption-lifecycle">Encryption Lifecycle</h5>
  <p>That one little encrypt call did a lot of work behind the scenes to
  keep your sensitive data safe:</p>
  <p><img src="./screenshots/lifecycle.png"
  alt="Protecting a file and sending the policy and key materials to Virtru" /></p>
  <ul>
    <li><p><strong>Step 1</strong>: Your app authenticates with Virtru's
    entity service.</p>
    <p><em>This was when you proved you were
    <code>alice@example.com</code>.</em></p></li>
    <li><p><strong>Step 2</strong>: Then, an encrypt call protects any given
    data as ciphertext. This ciphertext is local to where encrypt was called
    (a browser, end user device, or server). Although encrypt uses the open
    Trusted Data Format (TDF), you can save the ciphertext in a file format
    that you can open anywhere—HTML.</p>
    <p><em>This was when your sensitive data became protected.</em></p></li>
    <li><p><strong>Step 3</strong>: While an encrypt call keeps the
    protected data as local ciphertext, a secure decryption key travels back
    to Virtru’s key server for safe-keeping. But this key server doesn’t
    hand out keys to anyone…</p>
    <p><em>This is why you don’t have to manage keys yourself.</em></p></li>
    <li><p><strong>Step 4</strong>: While an encrypt call keeps the
    protected data as local ciphertext, the SDK saves the access controls
    for the protected data in Virtru’s access server. The access server
    determines if a particular authenticated user (Step 1) can access
    protected data (Step 2) using a decryption key (Step 3).</p>
    <p><em>This is the crucial backend you don’t have to build or host.
    <strong>It never has access to your local data.</strong></em></p></li>
  </ul>
  <hr />
  <h5 id="encrypted-file-formats">Encrypted File Formats</h5>
  <p>We generated a <code>.tdf.html</code> file above. This is the SDK
  default, but not the only option.</p>
  <table>
    <thead>
    <tr class="header">
      <th></th>
      <th>HTML Format</th>
      <th>ZIP Format</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
      <td>File Extension</td>
      <td>.tdf.html</td>
      <td>.tdf</td>
    </tr>
    <tr class="even">
      <td>File Size</td>
      <td>File sizes less than 100 MB</td>
      <td>Any file size</td>
    </tr>
    <tr class="odd">
      <td>Decryption</td>
      <td>Any Virtru SDK</td>
      <td>Any Virtru SDK</td>
    </tr>
    <tr class="even">
      <td>User Experience</td>
      <td>Open file anywhere to redirect to Virtru's Secure Reader</td>
      <td>Drag &amp; drop in Virtru's Secure Reader</td>
    </tr>
    </tbody>
  </table>
  <p>If you need a protected ZIP file, add it to the encrypt params and
  set the file extension:</p>
  <!--- SNIPPET protect-zip.js --->

<div class="sourceCode" id="cb22">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Encryption example - ZIP format</span></span>
      <span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protect</span>(unprotectedString) {</span>
      <span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
      <span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// specify access controls</span></span>
      <span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
      <span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
      <span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// protect &amp; output</span></span>
      <span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withStringSource</span>(unprotectedString)</span>
      <span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
      <span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withZipFormat</span>() <span class="co">// ZIP format</span></span>
      <span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
      <span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf&quot;</span><span class="op">;</span> <span class="co">// ZIP format</span></span>
      <span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
      <span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream</span>
      <span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
      <span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
      <span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  <p>And you’ll have a ZIP file with the same level of protection as HTML,
  but the caveats in the table above.</p>
  <h5 id="drag--drop-client-side-encryption-example">Drag &amp; Drop
  Client-side Encryption Example</h5>
  <p>Here is a complete example with drag &amp; drop uploads that get
  encrypted. Run the following code with Parcel as in the quick start.</p>
  <!--- TABS --->

  <!--- SNIPPET protect.html --->

  <!--- SNIPPET protect.js --->

  <!--- SNIPPET protect.css --->

  <!--- /TABS --->

<div class="sourceCode" id="cb23">
    <pre class="sourceCode html">
      <code class="sourceCode html">
        <span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
        <span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
        <span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;title&gt;</span>Protect | Virtru SDK for JavaScript - Sample Application<span class="kw">&lt;/title&gt;</span></span>
        <span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;link</span></span>
        <span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="ot">      href=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.css&quot;</span></span>
        <span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ot">      rel=</span><span class="st">&quot;stylesheet&quot;</span></span>
        <span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">/&gt;</span></span>
        <span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;link</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;./protect.css&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="kw">/&gt;</span></span>
        <span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/latest/auth-widget/index.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://sdk.virtru.com/js/2.1.0/virtru-sdk.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/head&gt;</span></span>
        <span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;body</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;unauthorized&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;h1&gt;</span>Encrypt a File<span class="kw">&lt;/h1&gt;</span></span>
        <span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;auth&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
        <span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;input&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;drop_zone&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;p&gt;</span>Drag a sensitive file here to encrypt it...<span class="kw">&lt;/p&gt;</span></span>
        <span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;/div&gt;</span></span>
        <span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
        <span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;waiting&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;p&gt;</span>Encrypting file...<span class="kw">&lt;/p&gt;</span></span>
        <span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
        <span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;download&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;a</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;download_link&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;noopener&quot;</span><span class="kw">&gt;</span>Save Protected File<span class="kw">&lt;/a&gt;</span></span>
        <span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
        <span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;error_box&quot;</span><span class="kw">&gt;</span></span>
        <span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;h3</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;error&quot;</span><span class="kw">&gt;</span>An error has occurred<span class="kw">&lt;/h3&gt;</span></span>
        <span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;p</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;detail&quot;</span><span class="kw">&gt;&lt;/p&gt;</span></span>
        <span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
        <span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;./protect.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
        <span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/body&gt;</span></span>
        <span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span>
      </code>
    </pre>
</div>
<div class="sourceCode" id="cb24">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
          <span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Virtru Client. This is set by the auth handler.</span></span>
          <span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
          <span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dragOverHandler</span>(e) {</span>
          <span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
          <span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Set the error message</span></span>
          <span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setAlert</span>(error<span class="op">,</span> detail) {</span>
          <span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (error) {</span>
          <span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;error&quot;</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> error<span class="op">;</span></span>
          <span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (detail) {</span>
          <span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;detail&quot;</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> detail<span class="op">;</span></span>
          <span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Encrypt a file, from a passed in File object.</span></span>
          <span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protect</span>(file) {</span>
          <span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> body <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">&quot;body&quot;</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
          <span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span> {</span>
          <span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    body<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">&quot;working&quot;</span><span class="op">;</span></span>
          <span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
          <span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withArrayBufferSource</span>(<span class="cf">await</span> file<span class="op">.</span><span class="fu">arrayBuffer</span>())</span>
          <span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withDisplayFilename</span>(file<span class="op">.</span><span class="at">name</span>)</span>
          <span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withHtmlFormat</span>()<span class="op">;</span></span>
          <span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// To allow other people to access it, add a Policy here using the PolicyBuilder.</span></span>
          <span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ciphertextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams<span class="op">.</span><span class="fu">build</span>())<span class="op">;</span></span>
          <span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ciphertextString <span class="op">=</span> <span class="cf">await</span> ciphertextStream<span class="op">.</span><span class="fu">toString</span>()<span class="op">;</span></span>
          <span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> a <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;download_link&quot;</span>)<span class="op">;</span></span>
          <span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span><span class="at">download</span> <span class="op">=</span> file<span class="op">.</span><span class="at">name</span> <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span><span class="at">href</span> <span class="op">=</span></span>
          <span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;data:text/html;charset=utf-8,&quot;</span> <span class="op">+</span> <span class="pp">encodeURIComponent</span>(ciphertextString)<span class="op">;</span></span>
          <span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    body<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">&quot;done&quot;</span><span class="op">;</span></span>
          <span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
          <span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">warn</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;encrypt failure&quot;</span><span class="op">,</span> <span class="dt">cause</span><span class="op">:</span> e })<span class="op">;</span></span>
          <span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">message</span>) {</span>
          <span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setAlert</span>(<span class="st">&quot;Encrypt service error&quot;</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>e<span class="op">.</span><span class="at">message</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
          <span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
          <span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setAlert</span>(</span>
          <span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Encrypt service error&quot;</span><span class="op">,</span></span>
          <span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Try refreshing credentials or starting over.&quot;</span></span>
          <span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
          <span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    }</span>
          <span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    body<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">&quot;error&quot;</span><span class="op">;</span></span>
          <span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
          <span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">dropHandler</span>(e) {</span>
          <span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
          <span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> edt <span class="op">=</span> e<span class="op">.</span><span class="at">dataTransfer</span><span class="op">;</span></span>
          <span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (edt<span class="op">.</span><span class="at">items</span>) {</span>
          <span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use DataTransferItemList interface to access the file(s)</span></span>
          <span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Not supported on IE or Safari.</span></span>
          <span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> item <span class="kw">of</span> edt<span class="op">.</span><span class="at">items</span>) {</span>
          <span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (item<span class="op">.</span><span class="at">kind</span> <span class="op">===</span> <span class="st">&quot;file&quot;</span>) {</span>
          <span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">protect</span>(item<span class="op">.</span><span class="fu">getAsFile</span>())<span class="op">;</span></span>
          <span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>      }</span>
          <span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    }</span>
          <span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
          <span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use DataTransfer interface to access the file(s)</span></span>
          <span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> file <span class="kw">of</span> edt<span class="op">.</span><span class="at">files</span>) {</span>
          <span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">protect</span>(file)<span class="op">;</span></span>
          <span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>    }</span>
          <span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Pass event to removeDragData for cleanup</span></span>
          <span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">removeDragData</span>(e)<span class="op">;</span></span>
          <span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">removeDragData</span>(ev) {</span>
          <span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Removing drag data&quot;</span>)<span class="op">;</span></span>
          <span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ev<span class="op">.</span><span class="at">dataTransfer</span><span class="op">.</span><span class="at">items</span>) {</span>
          <span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use DataTransferItemList interface to remove the drag data</span></span>
          <span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    ev<span class="op">.</span><span class="at">dataTransfer</span><span class="op">.</span><span class="at">items</span><span class="op">.</span><span class="fu">clear</span>()<span class="op">;</span></span>
          <span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
          <span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use DataTransfer interface to remove the drag data</span></span>
          <span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>    ev<span class="op">.</span><span class="at">dataTransfer</span><span class="op">.</span><span class="fu">clearData</span>()<span class="op">;</span></span>
          <span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
          <span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
          <span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> body <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">&quot;body&quot;</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
          <span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>  body<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">&quot;start&quot;</span><span class="op">;</span></span>
          <span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> dropZone <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;drop_zone&quot;</span>)<span class="op">;</span></span>
          <span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>dropZone<span class="op">.</span><span class="at">ondrop</span> <span class="op">=</span> dropHandler<span class="op">;</span></span>
          <span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>dropZone<span class="op">.</span><span class="at">ondragover</span> <span class="op">=</span> dragOverHandler<span class="op">;</span></span>
          <span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>Virtru<span class="op">.</span><span class="fu">AuthWidget</span>(<span class="st">&quot;auth&quot;</span><span class="op">,</span> { afterAuth })<span class="op">;</span></span>
        </code>
    </pre>
</div>

<div class="sourceCode" id="cb25">
  <pre class="sourceCode css">
    <code class="sourceCode css"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#input</span><span class="op">,</span></span>
      <span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#auth</span> {</span>
      <span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span>: <span class="dv">none</span><span class="op">;</span></span>
      <span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#drop_zone</span> {</span>
      <span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span>: <span class="dv">4</span><span class="dt">px</span> <span class="dv">dashed</span> <span class="cn">salmon</span><span class="op">;</span></span>
      <span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span>: <span class="dv">0</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">width</span>: <span class="dv">200</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">height</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#waiting</span> {</span>
      <span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span>: <span class="dv">8</span><span class="dt">px</span> <span class="dv">double</span> <span class="cn">gray</span><span class="op">;</span></span>
      <span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span>: <span class="dv">0</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">width</span>: <span class="dv">200</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">height</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span>: <span class="dv">none</span><span class="op">;</span></span>
      <span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#download</span> {</span>
      <span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border</span>: <span class="dv">4</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">blue</span><span class="op">;</span></span>
      <span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span>: <span class="dv">0</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">width</span>: <span class="dv">200</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">height</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span>: <span class="dv">none</span><span class="op">;</span></span>
      <span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="pp">#error_box</span> {</span>
      <span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">background</span>: <span class="cn">black</span><span class="op">;</span></span>
      <span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">border-radius</span>: <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">margin</span>: <span class="dv">0</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">em</span><span class="op">;</span></span>
      <span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">width</span>: <span class="dv">200</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">height</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
      <span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span>: <span class="dv">none</span><span class="op">;</span></span>
      <span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="kw">color</span>: <span class="cn">white</span><span class="op">;</span></span>
      <span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="fu">.unauthorized</span> <span class="pp">#auth</span><span class="op">,</span></span>
      <span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="fu">.start</span> <span class="pp">#input</span><span class="op">,</span></span>
      <span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="fu">.working</span> <span class="pp">#waiting</span><span class="op">,</span></span>
      <span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="fu">.done</span> <span class="pp">#download</span><span class="op">,</span></span>
      <span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="fu">.error</span> <span class="pp">#error_box</span> {</span>
      <span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></span>
      <span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  
<h3 id="decrypt">Decrypt</h3>
  <p>Well Alice, the good news is, your first encrypted file is so safe,
  only you can decrypt it. Let’s confirm that with your protected file.
  Then, we’ll grant access to someone you trust.</p>
  <h5 id="meet-secure-reader-the-easiest-way-to-decrypt">Meet Secure
  Reader, the easiest way to decrypt</h5>
  <p>Opening a protected HTML file will take you to Virtru’s Secure
  Reader.</p>
  <p><img src=".screenshots/auth.png"
  alt="Authenticating with Virtru Secure Reader" /></p>
  <p>Secure Reader will also ask you to authenticate. Again, no one trusts
  that you’re Alice. But trust us, it’s good for security. If Mallory
  tries to authenticate, he won’t see your sensitive data.</p>
  <p>But if you authenticate, Secure Reader will render your file.</p>
  <p><img src=".screenshots/decrypt.png"
  alt="Decrypting with Virtru Secure Reader" /></p>
  <p>If Secure Reader can’t render the file, you will still be able to
  download it.</p>
  <h5 id="decrypting-via-sdk">Decrypting via SDK</h5>
  <p>Outside of Secure Reader, you can also decrypt a file via the
  SDK:</p>
  <!--- SNIPPET decrypt-minimal.js --->

<div class="sourceCode" id="cb26">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Decryption example</span></span>
      <span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">// decrypt from protected file arraybuffer and save as a new file unprotected file</span></span>
      <span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">decrypt</span>(protectedFile<span class="op">,</span> unprotectedFile) {</span>
      <span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare</span></span>
      <span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// access &amp; output</span></span>
      <span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plaintextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">decrypt</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> plaintextStream</span>
      <span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(unprotectedFile)</span>
      <span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Decrypted file </span><span class="sc">${</span>unprotectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
      <span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  
<h5 id="allowing-others-to-decrypt">Allowing others to decrypt</h5>
  <p>But let’s say you wanted to share your sensitive data with your
  trusted colleague Bob, whose email is <code>bob@example.com</code>.</p>
  <p>For existing files, you would grant access to
  <code>bob@example.com</code> and save the changes to the Virtru
  Platform.</p>
<div class="sourceCode" id="cb27">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> newPolicy <span class="op">=</span> policy</span>
      <span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;bob@example.com&quot;</span>])</span>
      <span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(newPolicy)<span class="op">;</span></span>
    </code>
  </pre>
</div>
  
<p>Now, <code>bob@example.com</code> should be able to view your
  sensitive data in Secure Reader (anywhere) or via the SDK decrypt call
  (in your apps).</p>
  <p>When protecting new files, you can grant access to Bob or any number
  of users as part of encryption params:</p>
<div class="sourceCode" id="cb28">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
      <span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;bob@example.com&quot;</span>])</span>
      <span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withStringSource</span>(<span class="st">&quot;sensitive data&quot;</span>)</span>
      <span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withDisplayFilename</span>(<span class="st">&quot;sensitive.txt&quot;</span>)</span>
      <span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
      <span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> protectedStream<span class="op">.</span><span class="fu">toFile</span>(<span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)<span class="op">;</span></span>
    </code>
  </pre>
</div>
  
<h3 id="access-control">Access Control</h3>
  <p>No one can predict the future. Access controls let you change your
  mind about who has access and under what conditions.</p>
  <h5 id="grant-access">Grant Access</h5>
  <p>Let’s say Bob enters your circle of trust. If you grant him access,
  he can decrypt your sensitive data.</p>
  <!--- SNIPPET grant-existing.js --->

<div class="sourceCode" id="cb29">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Grant existing policy</span></span>
      <span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">grantAccess</span>(protectedFile) {</span>
      <span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(params)<span class="op">;</span></span>
      <span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// update users</span></span>
      <span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> initialUsers <span class="op">=</span> <span class="cf">await</span> existingPolicy<span class="op">.</span><span class="fu">getUsersWithAccess</span>()<span class="op">;</span></span>
      <span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Initial users with access: &quot;</span> <span class="op">+</span> initialUsers)<span class="op">;</span></span>
      <span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
      <span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
      <span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>(users)</span>
      <span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
      <span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Granted access to users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs"> on encrypted file`</span>)<span class="op">;</span></span>
      <span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  <p>You can also grant access before you encrypt:</p>
  <!--- SNIPPET grant-new.js --->

<div class="sourceCode" id="cb30">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Grant new policy</span></span>
      <span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protectWithAccess</span>(unprotectedString) {</span>
      <span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
      <span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare policy</span></span>
      <span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
      <span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()<span class="op">.</span><span class="fu">addUsersWithAccess</span>(users)<span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
      <span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withStringSource</span>(unprotectedString)</span>
      <span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
      <span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
      <span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// encrypt</span></span>
      <span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
      <span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
      <span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
      <span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream<span class="op">.</span><span class="fu">toFile</span>(protectedFile)<span class="op">;</span></span>
      <span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
      <span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs"> and granted access to users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs">`</span></span>
      <span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
      <span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  <h5 id="revoke-access">Revoke Access</h5>
  <p>Let’s say Bob leaves your circle of trust. It’d be great if he no
  longer had access to your sensitive data. Revoke will prevent Bob from
  decrypting your sensitive data:</p>
  <!--- SNIPPET revoke.js --->

<div class="sourceCode" id="cb31">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Revoke access</span></span>
      <span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">revokeAccess</span>(protectedFile) {</span>
      <span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(params)<span class="op">;</span></span>
      <span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// revoke access for user(s)</span></span>
      <span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
      <span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
      <span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">removeUsersWithAccess</span>(users)</span>
      <span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
      <span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Revoked access from users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs"> on encrypted file`</span>)<span class="op">;</span></span>
      <span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  <p>You will still have access to your sensitive data.</p>
  <h5 id="revoke-all-access">Revoke All Access</h5>
  <p>Let’s say you landed a new job, Alice. Well done! But your circle of
  trust becomes outdated. Rather than removing every Bob from accessing
  your sensitive data, you can remove everyone with revoke all:</p>
  <!--- SNIPPET revoke-all.js --->

<div class="sourceCode" id="cb32">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Revoke all access</span></span>
      <span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">revokeAll</span>(protectedFile) {</span>
      <span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// revoke access for all users</span></span>
      <span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">revokePolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Revoked access for all users on encrypted file`</span>)<span class="op">;</span></span>
      <span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  
<p>You will still have access to your sensitive data.</p>
  <h5 id="expire-access">Expire Access</h5>
  <p>Some things aren’t meant to last. Your landlord, Trent, shouldn’t
  have access to the sensitive data in your lease forever. Let’s make sure
  your sensitive data expires in a year when your lease does:</p>
  <!--- SNIPPET expire-relative.js --->

<div class="sourceCode" id="cb33">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Expire access with relative datetime</span></span>
      <span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireRelative</span>(protectedFile) {</span>
      <span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// expire access</span></span>
      <span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> secondsInYear <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">365</span><span class="op">;</span> <span class="co">// min * hour * day * year;</span></span>
      <span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
      <span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableExpirationDeadlineFromNow</span>(secondsInYear)</span>
      <span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
      <span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Expire access to encrypted file in </span><span class="sc">${</span>secondsInYear<span class="sc">}</span><span class="vs"> seconds`</span>)<span class="op">;</span></span>
      <span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  <p>You can also expire at a specific date and time:</p>
  <!--- SNIPPET expire-specific.js --->

<div class="sourceCode" id="cb34">
  <pre class="sourceCode javascript">
    <code class="sourceCode javascript">
      <span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Expire access with specific datetime</span></span>
      <span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireSpecific</span>(protectedFile) {</span>
      <span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// expire access</span></span>
      <span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> expiresOn <span class="op">=</span> <span class="st">&quot;2022-08-12T14:37:26.101Z&quot;</span><span class="op">;</span> <span class="co">// ISO-8601 Format</span></span>
      <span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
      <span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableExpirationDeadline</span>(expiresOn)</span>
      <span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
      <span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Expire access to encrypted file on </span><span class="sc">${</span>expiresOn<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
      <span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
  
<p>Expiration prevents everyone else on the policy from decrypting after
  that time. You will still have access.</p>
  <p>Make the same expiration calls to update dates or times.</p>
  <p>If you’re feeling permissive, you can always remove expiration
  too:</p>
  <!--- SNIPPET expire-disable.js --->

  <div class="sourceCode" id="cb35">
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
      <span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Remove access expiration</span></span>
      <span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
      <span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
      <span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
      <span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
      <span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
      <span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireDisable</span>(protectedFile) {</span>
      <span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
      <span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
      <span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
      <span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
      <span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
      <span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
      <span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// remove access expiration</span></span>
      <span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
      <span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
      <span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">disableExpirationDeadline</span>()</span>
      <span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
      <span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
      <span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Removed access expiration on encrypted file`</span>)<span class="op">;</span></span>
      <span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
 </div>
 
 <h5 id="watermark-access">Watermark Access</h5>
 <p>Trust doesn’t have to be absolute. If you want Bob to access your
    sensitive data, but discourage him from sharing it, you can enable
    watermarking:
 </p>
 <!--- SNIPPET watermark-enable.js --->
 
 <div class="sourceCode" id="cb36">
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Enable access watermark</span></span>
   <span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
   <span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
   <span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
   <span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
   <span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">watermarkEnable</span>(protectedFile) {</span>
   <span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
   <span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
   <span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
   <span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
   <span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
   <span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// watermark access</span></span>
   <span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
   <span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
   <span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableWatermarking</span>()</span>
   <span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
   <span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Enabled watermark when accessing encrypted file`</span>)<span class="op">;</span></span>
   <span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>}</span>
 </code>
 </pre>
 </div>
 <p>This option only applies in Virtru’s Secure Reader, where Bob’s email
    address will always overlay the decrypted sensitive data.
 </p>
 <p>To disable watermarking:</p>
 <!--- SNIPPET watermark-disable.js --->
 
 
 <div class="sourceCode" id="cb37">
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Disable access watermark</span></span>
   <span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> client<span class="op">;</span></span>
   <span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">// assumes Virtru auth widget</span></span>
   <span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">afterAuth</span>(email) {</span>
   <span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email })<span class="op">;</span></span>
   <span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">watermarkDisable</span>(protectedFile) {</span>
   <span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
   <span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
   <span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withArrayBufferSource</span>(protectedFile)</span>
   <span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
   <span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
   <span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// watermark access</span></span>
   <span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
   <span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
   <span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">disableWatermarking</span>()</span>
   <span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
   <span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Disabled watermark when accessing encrypted file`</span>)<span class="op">;</span></span>
   <span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>}</span>
 </code>
 </pre>
 </div>
 </div> <!-- Js sdk Wrapper end-->
 <!-- Nodejs SDK-->
 <div id="nodejs_sdk_wrapper" class="sdk_wrapper">
    <h3 id="virtru-sdk-for-nodejs">Virtru SDK for Node.js</h3>
    <blockquote>
       <p><a href="https://docs.developer.virtru.com/js/2.1.0/">JavaScript SDK
          Documentation</a>
       </p>
    </blockquote>
    <h4 id="quick-start-1">Quick Start</h4>
    <p>You’re Alice and you have sensitive data to protect. (Don’t we all?)</p>
    <p>Let’s see the fastest way to protect it server-side with the Virtru SDK.</p>
    <h5 id="prerequisites-1">Prerequisites</h5>
    <ol type="1">
       <li>Node.js 12 or higher</li>
    </ol>
    <h5 id="1-install-the-sdk">1. Install the SDK</h5>
    <p>We recommend installing our node package locally. That way, different projects can experiment with different versions of the Virtru SDK. After installing, you can verify the version you’re using:</p>
    <blockquote>
       <p>Note: These steps assume a *nix style command line, as available in macOS and linux</p>
    </blockquote>
    <pre class="shell"><code>npm install virtru-sdk@2.1.0 node -e &quot;console.log(&#39;Using virtru-sdk: &#39; + require(&#39;virtru-sdk&#39;).Version)&quot;</code></pre>
    <h5 id="2-get-an-identity">2. Get an identity</h5>
    <p>So Alice, who should own your sensitive data? You, obviously!</p>
    <p>Authenticate to associate your email address (e.g.
       <code>alice@example.com</code>) with any data you protect. <strong>You
       cannot protect data without authenticating.</strong> If the Virtru
       Platform doesn’t know who’s protecting data, no one would be able to
       access it later (when they’re also asked to authenticate).
    </p>
    <p>The fastest way to authenticate on the server side is with an appId
       token. You can generate one from the <a
          href="https://secure.virtru.com/dashboard#/settings">Virtru
       Dashboard</a>. If you need help, <a
          href="https://developer.virtru.com/docs/how-to-download-appid-token">see
       detailed steps</a>.
    </p>
    <p>For safekeeping, don’t hard code your appID anywhere. A more secure
       option is to store it in your local environment:
    </p>
    <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
   export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
    <p>To protect your sensitive data, we’ll need a Virtru client. We’ll
       associate anything you encrypt with your email and appId. Let’s make
       sure your email and appId can create a valid Virtru client to make
       further SDK calls.
    </p>
    <!--- SNIPPET 02-identify.js --->
<div class="sourceCode" id="cb40">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Quick Start - Step 2 - Get an identity</span></span>
   <span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Set the environment variables:</span></span>
   <span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_APP_ID: AppId Token from https://secure.virtru.com/dashboard#/settings</span></span>
   <span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_EMAIL: Email address used for https://secure.virtru.com/dashboard#/profile</span></span>
   <span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Please note, the identity used will be associated with any policies created.</span></span>
   <span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
   <span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span> {</span>
   <span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
   <span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
   <span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(</span>
   <span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span></span>
   <span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
   <span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
   <span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    }</span>
   <span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
   <span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Ready to protect!&quot;</span>)<span class="op">;</span></span>
   <span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> client<span class="op">;</span></span>
   <span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">catch</span> (error) {</span>
   <span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(error)<span class="op">;</span></span>
   <span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
   <span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  }</span>
   <span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span><span class="op">.</span><span class="at">client</span> <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <pre class="shell"><code>node 02-identify.js</code></pre>
    <h5 id="3-ask-for-sensitive-data">3. Ask for sensitive data</h5>
    <p>Now that we know who will own things, why don’t you enter your first
       piece of sensitive data? For simplicity’s sake, create a file named
       “sensitive.txt” with your sensitive data.
    </p>
    <pre class="shell"><code>echo &quot;sensitive data&quot; &gt; ./sensitive.txt</code></pre>
    <h5 id="4-protect-the-sensitive-data">4. Protect the sensitive data</h5>
    <p>Next, <strong>decide your encryption options</strong>. For now, it’s
       the file containing your sensitive data. In the future, this could
       include who else should have access and under what conditions.
    </p>
    <!--- SNIPPET 04-protect.js --->
<div class="sourceCode" id="cb43">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Quick Start - Step 4 - Protect the Sensitive Data</span></span>
   <span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { Client<span class="op">,</span> EncryptParamsBuilder } <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protectToFile</span>(unprotectedFile) {</span>
   <span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">//auth</span></span>
   <span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
   <span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
   <span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
   <span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  }</span>
   <span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> <span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
   <span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare</span></span>
   <span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
   <span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
   <span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> <span class="fu">EncryptParamsBuilder</span>()</span>
   <span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(unprotectedFile)</span>
   <span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
   <span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// protect &amp; output</span></span>
   <span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
   <span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream</span>
   <span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
   <span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
   <span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> protectedStream<span class="op">;</span></span>
   <span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
   <span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
   <span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">protectToFile</span>(unprotectedFile)</span>
   <span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">catch</span>(e <span class="kw">=&gt;</span> {</span>
   <span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(e)<span class="op">;</span></span>
   <span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>      <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">1</span>)<span class="op">;</span></span>
   <span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    })</span>
   <span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Done`</span>))<span class="op">;</span></span>
   <span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span><span class="op">.</span><span class="at">protectToFile</span> <span class="op">=</span> protectToFile<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <p>Then, invoke the code using:</p>
    <pre class="shell"><code>node 04-protect.js</code></pre>
    <h5 id="5-access-the-sensitive-data">5. Access the sensitive data</h5>
    <p>Now, let’s say you need to see your sensitive data again.
       Authenticate as <code>alice@example.com</code> again and you can decrypt
       the protected file.
    </p>
    <!--- SNIPPET 05-access.js --->
<div class="sourceCode" id="cb45">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Quick Start - Step 5 - Access the Sensitive Data</span></span>
   <span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { Client<span class="op">,</span> DecryptParamsBuilder } <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">accessToFile</span>(protectedFile<span class="op">,</span> unprotectedFile) {</span>
   <span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">//auth</span></span>
   <span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
   <span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
   <span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
   <span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  }</span>
   <span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> <span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
   <span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare</span></span>
   <span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> <span class="fu">DecryptParamsBuilder</span>()</span>
   <span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
   <span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">// access &amp; output</span></span>
   <span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plaintextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">decrypt</span>(decryptParams)<span class="op">;</span></span>
   <span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> plaintextStream</span>
   <span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(unprotectedFile)</span>
   <span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Decrypted file </span><span class="sc">${</span>unprotectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
   <span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plaintextStream<span class="op">;</span></span>
   <span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
   <span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
   <span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive_decrypted.txt&quot;</span><span class="op">;</span></span>
   <span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accessToFile</span>(protectedFile<span class="op">,</span> unprotectedFile)</span>
   <span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">catch</span>(e <span class="kw">=&gt;</span> {</span>
   <span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(e)<span class="op">;</span></span>
   <span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>      <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">1</span>)<span class="op">;</span></span>
   <span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    })</span>
   <span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Done`</span>))<span class="op">;</span></span>
   <span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span><span class="op">.</span><span class="at">accessToFile</span> <span class="op">=</span> accessToFile<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <p>The decrypted file should match your original one with the sensitive
       data:
    </p>
    <pre class="shell"><code>node 05-access.js
   diff sensitive.txt sensitive_decrypted.txt</code></pre>
    <h5 id="6-access-the-sensitive-data-anywhere-1">6. Access the sensitive
       data anywhere
    </h5>
    <p>If you inspect the generated HTML file, you still won’t find your
       sensitive data. It stays protected. You can send that HTML file to
       another machine or anywhere you want. Only you will be able to access
       it. But how do you do that outside of this code?
    </p>
    <p>We could build a whole set of functionality to authenticate, decrypt,
       and render files. Or we could <strong>use Virtru’s Secure
       Reader</strong>, which is built to do exactly that for thousands of
       security-conscious users every day. In fact, if you open that HTML file
       from the last step, it will redirect you to Secure Reader.
    </p>
    <p>Secure Reader will ask you to authenticate. (You’re still Alice,
       aren’t you?)
    </p>
    <p><img src=".screenshots/auth.png"
       alt="Authenticating with Virtru Secure Reader" /></p>
    <p>And if you authenticate with the same email address you used to
       create the HTML file, you should be able to view it in Secure
       Reader:
    </p>
    <p><img src=".screenshots/decrypt.png"
       alt="Decrypting with Virtru Secure Reader" /></p>
    <p>Congrats Alice! <strong>Your sensitive data is safe wherever it
       goes</strong>.
    </p>
    <h4 id="authentication-1">Authentication</h4>
    <p>Security starts with identity. You claim you’re Alice, but the Virtru
       SDK doesn’t know that. <strong>We can’t protect or access data without
       an identity that’s responsible for protecting or accessing that
       data</strong>. Otherwise, no one (or anyone) would be able to do
       whatever they want with your data. But we all have sensitive data to
       protect.
    </p>
    <p>So how do you prove your identity to the Virtru SDK? We’re glad you
       asked, “Alice…”
    </p>
    <p>Here are your options on the server-side:</p>
    <ul>
       <li>Use an appId Token from the Virtru Dashboard</li>
       <li>Provision HMAC Token &amp; Secret Pairs</li>
    </ul>
    <hr />
    <h5 id="appid-token">appId Token</h5>
    <p>Generate an appId from the <a
       href="https://secure.virtru.com/dashboard#/settings">Virtru
       Dashboard</a>. If you need help, <a
          href="https://developer.virtru.com/docs/how-to-download-appid-token">see
       detailed steps</a>.
    </p>
    <p>Key points about appId authentication:</p>
    <ul>
       <li>appIds expire in 120 days</li>
       <li>appIds are tied to your email address (i.e. your login to Virtru
          Dashboard)
       </li>
       <li>appIds <strong>cannot be used</strong> to encrypt or decrypt data on
          behalf of your app’s end users
       </li>
    </ul>
    <p>For safekeeping, <strong>don’t hard code your appID
       anywhere</strong>. A more secure option is to store it in your local
       environment:
    </p>
    <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
   export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
    <p>A combination of email &amp; appId can be used to create a Virtru
       client and make all other SDK calls:
    </p>
    <!--- SNIPPET auth-appid.js --->
<div class="sourceCode" id="cb48">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Authentication by AppId Token</span></span>
   <span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Set the environment variables:</span></span>
   <span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_APP_ID: AppId Token from https://secure.virtru.com/dashboard#/settings</span></span>
   <span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_EMAIL: Email address used for https://secure.virtru.com/dashboard#/profile</span></span>
   <span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Please note, the identity used will be associated with any policies created.</span></span>
   <span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> {</span>
   <span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
   <span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
   <span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(</span>
   <span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span></span>
   <span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
   <span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
   <span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  }</span>
   <span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
   <span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Ready to protect!&quot;</span>)<span class="op">;</span></span>
   <span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>} <span class="cf">catch</span> (error) {</span>
   <span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(error)<span class="op">;</span></span>
   <span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">1</span>)<span class="op">;</span></span>
   <span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <hr />
    <h5 id="hmac-token--secret-pairs">HMAC Token &amp; Secret Pairs</h5>
    <p>HMAC authentication is a long-lived alternative to appIds.</p>
    <p>Key points about HMAC authentication:</p>
    <ul>
       <li>HMAC does not expire</li>
       <li>HMAC is tied to your domain</li>
       <li>HMAC <strong>can only be used</strong> to encrypt or decrypt data on
          behalf of your <strong>domain’s</strong> users
       </li>
    </ul>
    <p>Thus, Virtru must provision an HMAC token &amp; secret pair. <a
       href="https://www.virtru.com/contact-us/">Contact Virtru for HMAC
       provisioning</a>.
    </p>
    <p>If you provision an HMAC token &amp; secret pair for example.com,
       <code>bob@example.com</code> can use your server-side app to encrypt his
       data and control who has access. A different domain, such as
       <code>bob@elsewhere.com</code> will not be able to encrypt or decrypt
       data with your server-side app. Emails in other domains would need to
       use a client-side app or Secure Reader to access the same data.
    </p>
    <p>For safekeeping, <strong>don’t hard code your HMAC token &amp; secret
       pair anywhere</strong>. A more secure option would be to store them in
       your local environment:
    </p>
    <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
   export VIRTRU_SDK_HMAC_TOKEN=[paste from Virtru provisioning email]
   export VIRTRU_SDK_HMAC_APP_SECRET=[paste from Virtru provisioning email]</code></pre>
    <p>The HMAC token &amp; secret pair can be used to create a Virtru
       client and make all other SDK calls:
    </p>
    <!--- SNIPPET auth-hmac.js --->
<div class="sourceCode" id="cb50">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Authentication by HMAC Token &amp; Secret</span></span>
   <span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Set the environment variables:</span></span>
   <span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_HMAC_TOKEN:</span></span>
   <span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">//       A generated ID for your organization&#39;s applications and services</span></span>
   <span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_HMAC_APP_SECRET:</span></span>
   <span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">//       The corresponding secret</span></span>
   <span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">//   VIRTRU_SDK_EMAIL:</span></span>
   <span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">//       Email address to be associated with any policies. User must be a</span></span>
   <span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">//       member of the organization associated with the above token pair.</span></span>
   <span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> hmacToken <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_HMAC_TOKEN</span><span class="op">;</span></span>
   <span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> hmacSecret <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_HMAC_APP_SECRET</span><span class="op">;</span></span>
   <span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>hmacToken <span class="op">||</span> <span class="op">!</span>hmacSecret) {</span>
   <span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(</span>
   <span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_HMAC_TOKEN</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_HMAC_APP_SECRET&quot;</span></span>
   <span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
   <span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">1</span>)<span class="op">;</span></span>
   <span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> hmacToken<span class="op">,</span> hmacSecret })<span class="op">;</span></span>
   <span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="op">!</span>client) {</span>
   <span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(<span class="st">&quot;Virtru client failed to initialize&quot;</span>)<span class="op">;</span></span>
   <span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">1</span>)<span class="op">;</span></span>
   <span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Ready to protect!&quot;</span>)<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <hr />
    <h4 id="encrypt-1">Encrypt</h4>
    <p>Now that the Virtru SDK knows you’re Alice, you can protect your
       first piece of data.
    </p>
    <h5 id="encryption-basics-1">Encryption Basics</h5>
    <p>Before calling encrypt, you need to specify a few simple
       parameters.
    </p>
    <p>You don’t need to include your email address when encrypting. You
       will already have access to anything you encrypt because you
       authenticated. But if you want anyone else to have access (like another
       one of your emails, <code>alice@nowhere.com</code>), you could include
       them here:
    </p>
    <!--- SNIPPET protect-html.js 16 26 --->
<div class="sourceCode" id="cb51">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">// specify access controls</span></span>
   <span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
   <span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
   <span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">// protect &amp; output</span></span>
   <span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
   <span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withFileSource</span>(unprotectedFile)</span>
   <span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
   <span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
   <span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <p>Call encrypt and check out the resulting file:</p>
    <!--- SNIPPET protect-html.js 27 32 --->
<div class="sourceCode" id="cb52">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
   <span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
   <span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
   <span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> protectedStream</span>
   <span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
   <span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <p>Here's the complete source code:</p>
    <!--- SNIPPET protect-html.js --->
<div class="sourceCode" id="cb53">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Encryption example - HTML format</span></span>
   <span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
   <span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
   <span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
   <span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
   <span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
   <span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
   <span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  }</span>
   <span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
   <span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protect</span>(unprotectedFile) {</span>
   <span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
   <span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// specify access controls</span></span>
   <span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
   <span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
   <span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// protect &amp; output</span></span>
   <span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
   <span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(unprotectedFile)</span>
   <span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
   <span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
   <span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
   <span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
   <span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
   <span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
   <span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream</span>
   <span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
   <span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
   <span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>}</span>
   <span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
   <span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
   <span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
   <span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
   <span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">protect</span>(unprotectedFile)<span class="op">;</span></span>
   <span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <pre class="shell"><code>node protect-html.js</code></pre>
    <p>Now, your sensitive data is safe. Keep reading to see how or access
       your data by decrypting.
    </p>
    <hr />
    <h5 id="encryption-lifecycle-1">Encryption Lifecycle</h5>
    <p>That one little encrypt call did a lot of work behind the scenes to
       keep your sensitive data safe:
    </p>
    <p><img src=".screenshots/lifecycle.png"
       alt="Protecting a file and sending the policy and key materials to Virtru" /></p>
    <ul>
       <li>
          <p><strong>Step 1</strong>: Your app authenticates with Virtru's
             entity service.
          </p>
          <p><em>This was when you proved you were
             <code>alice@example.com</code>.</em>
          </p>
       </li>
       <li>
          <p><strong>Step 2</strong>: Then, an encrypt call protects any given
             data as ciphertext. This ciphertext is local to where encrypt was called
             (a browser, end user device, or server). Although encrypt uses the open
             Trusted Data Format (TDF), you can save the ciphertext in a file format
             that you can open anywhere—HTML.
          </p>
          <p><em>This was when your sensitive data became protected.</em></p>
       </li>
       <li>
          <p><strong>Step 3</strong>: While an encrypt call keeps the
             protected data as local ciphertext, a secure decryption key travels back
             to Virtru’s key server for safe-keeping. But this key server doesn’t
             hand out keys to anyone…
          </p>
          <p><em>This is why you don’t have to manage keys yourself.</em></p>
       </li>
       <li>
          <p><strong>Step 4</strong>: While an encrypt call keeps the
             protected data as local ciphertext, the SDK saves the access controls
             for the protected data in Virtru’s access server. The access server
             determines if a particular authenticated user (Step 1) can access
             protected data (Step 2) using a decryption key (Step 3).
          </p>
          <p><em>This is the crucial backend you don’t have to build or host.
             <strong>It never has access to your local data.</strong></em>
          </p>
       </li>
    </ul>
    <hr />
    <h5 id="encrypted-file-formats-1">Encrypted File Formats</h5>
    <p>We generated a <code>.tdf.html</code> file above. This is the SDK
       default, but not the only option.
    </p>
    <table>
       <thead>
          <tr class="header">
             <th></th>
             <th>HTML Format</th>
             <th>ZIP Format</th>
          </tr>
       </thead>
       <tbody>
          <tr class="odd">
             <td>File Extension</td>
             <td>.tdf.html</td>
             <td>.tdf</td>
          </tr>
          <tr class="even">
             <td>File Size</td>
             <td>File sizes less than 100 MB</td>
             <td>Any file size</td>
          </tr>
          <tr class="odd">
             <td>Decryption</td>
             <td>Any Virtru SDK</td>
             <td>Any Virtru SDK</td>
          </tr>
          <tr class="even">
             <td>User Experience</td>
             <td>Open file anywhere to redirect to Virtru's Secure Reader</td>
             <td>Drag &amp; drop in Virtru's Secure Reader</td>
          </tr>
       </tbody>
    </table>
    <p>If you need a protected ZIP file, add it to the encrypt params and
       set the file extension:
    </p>
    <!--- SNIPPET protect-zip.js --->
<div class="sourceCode" id="cb55">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Encryption example - ZIP format</span></span>
          <span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protect</span>(unprotectedFile) {</span>
          <span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// specify access controls</span></span>
          <span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
          <span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
          <span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// protect &amp; output</span></span>
          <span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
          <span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(unprotectedFile)</span>
          <span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withZipFormat</span>() <span class="co">// ZIP format</span></span>
          <span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
          <span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
          <span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
          <span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf&quot;</span><span class="op">;</span> <span class="co">// ZIP format</span></span>
          <span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
          <span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream</span>
          <span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(protectedFile)</span>
          <span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
          <span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
          <span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">protect</span>(unprotectedFile)<span class="op">;</span></span>
          <span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <pre class="shell"><code>node protect-zip.js</code></pre>
    <p>And you’ll have a ZIP file with the same level of protection as HTML,
       but the caveats in the table above.
    </p>
    <h4 id="decrypt-1">Decrypt</h4>
    <p>Well Alice, the good news is, your first encrypted file is so safe,
       only you can decrypt it. Let’s confirm that with your protected file.
       Then, we’ll grant access to someone you trust.
    </p>
    <h5 id="meet-secure-reader-the-easiest-way-to-decrypt-1">Meet Secure
       Reader, the easiest way to decrypt
    </h5>
    <p>Opening a protected HTML file will take you to Virtru’s Secure
       Reader.
    </p>
    <p><img src=".screenshots/auth.png"
       alt="Authenticating with Virtru Secure Reader" /></p>
    <p>Secure Reader will also ask you to authenticate. Again, no one trusts
       that you’re Alice. But trust us, it’s good for security. If Mallory
       tries to authenticate, he won’t see your sensitive data.
    </p>
    <p>But if you authenticate, Secure Reader will render your file.</p>
    <p><img src=".screenshots/decrypt.png"
       alt="Decrypting with Virtru Secure Reader" /></p>
    <p>If Secure Reader can’t render the file, you will still be able to
       download it.
    </p>
    <h5 id="decrypting-via-sdk-1">Decrypting via SDK</h5>
    <p>Outside of Secure Reader, you can also decrypt a file via the
       SDK:
    </p>
    <!--- SNIPPET decrypt.js --->
<div class="sourceCode" id="cb57">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Decryption example</span></span>
          <span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">decrypt</span>(protectedFile<span class="op">,</span> unprotectedFile) {</span>
          <span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare</span></span>
          <span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// access &amp; output</span></span>
          <span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plaintextStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">decrypt</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> plaintextStream</span>
          <span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">toFile</span>(unprotectedFile)</span>
          <span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Decrypted file </span><span class="sc">${</span>unprotectedFile<span class="sc">}</span><span class="vs">`</span>))<span class="op">;</span></span>
          <span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plaintextStream<span class="op">;</span></span>
          <span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive_decrypted.txt&quot;</span><span class="op">;</span></span>
          <span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decrypt</span>(protectedFile<span class="op">,</span> unprotectedFile)<span class="op">;</span></span>
          <span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    
<pre class="shell"><code>node decrypt.js</code></pre>
    <h5 id="allowing-others-to-decrypt-1">Allowing others to decrypt</h5>
    <p>But let’s say you wanted to share your sensitive data with your
       trusted colleague Bob, whose email is <code>bob@example.com</code>.
    </p>
    <p>For existing files, you would grant access to
       <code>bob@example.com</code> and save the changes to the Virtru
       Platform.
    </p>
<div class="sourceCode" id="cb59">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withFileSource</span>(<span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
          <span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> newPolicy <span class="op">=</span> policy</span>
          <span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;bob@example.com&quot;</span>])</span>
          <span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(newPolicy)<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <p>Now, <code>bob@example.com</code> should be able to view your
       sensitive data in Secure Reader (anywhere) or via the SDK decrypt call
       (in your apps).
    </p>
    <p>When protecting new files, you can grant access to Bob or any number
       of users as part of encryption params:
    </p>
<div class="sourceCode" id="cb60">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()</span>
        <span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">addUsersWithAccess</span>([<span class="st">&quot;bob@example.com&quot;</span>])</span>
        <span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
        <span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withFileSource</span>(<span class="st">&quot;sensitive.txt&quot;</span>)</span>
        <span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withDisplayFilename</span>(<span class="st">&quot;sensitive.txt&quot;</span>)</span>
        <span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
        <span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
        <span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> protectedStream<span class="op">.</span><span class="fu">toFile</span>(<span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)<span class="op">;</span></span>
    </code>
  </pre>
</div>
    <h4 id="access-control-1">Access Control</h4>
    <p>No one can predict the future. Access controls let you change your
       mind about who has access and under what conditions.
    </p>
    <h5 id="grant-access-1">Grant Access</h5>
    <p>Let’s say Bob enters your circle of trust. If you grant him access,
       he can decrypt your sensitive data.
    </p>
    <!--- SNIPPET grant-existing.js --->
<div class="sourceCode" id="cb61">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Grant existing policy</span></span>
          <span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">grantAccess</span>(protectedFile) {</span>
          <span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(params)<span class="op">;</span></span>
          <span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// update users</span></span>
          <span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> initialUsers <span class="op">=</span> <span class="cf">await</span> existingPolicy<span class="op">.</span><span class="fu">getUsersWithAccess</span>()<span class="op">;</span></span>
          <span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Initial users with access: &quot;</span> <span class="op">+</span> initialUsers)<span class="op">;</span></span>
          <span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
          <span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
          <span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addUsersWithAccess</span>(users)</span>
          <span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
          <span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
          <span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Granted access to users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs"> on encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span></span>
          <span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
          <span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grantAccess</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>You can also grant access before you encrypt:</p>
    <!--- SNIPPET grant-new.js --->
<div class="sourceCode" id="cb62">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Grant new policy</span></span>
        <span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
        <span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
        <span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
        <span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
        <span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
        <span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
        <span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  }</span>
        <span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
        <span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">protectWithAccess</span>(unprotectedFile) {</span>
        <span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
        <span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prepare policy</span></span>
        <span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
        <span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policy <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">PolicyBuilder</span>()<span class="op">.</span><span class="fu">addUsersWithAccess</span>(users)<span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
        <span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(unprotectedFile)</span>
        <span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(unprotectedFile)</span>
        <span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withPolicy</span>(policy)</span>
        <span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">// encrypt</span></span>
        <span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedStream <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
        <span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> protectedExt <span class="op">=</span> <span class="st">&quot;.tdf.html&quot;</span><span class="op">;</span> <span class="co">// HTML format</span></span>
        <span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> unprotectedFile <span class="op">+</span> protectedExt<span class="op">;</span></span>
        <span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> protectedStream<span class="op">.</span><span class="fu">toFile</span>(protectedFile)<span class="op">;</span></span>
        <span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
        <span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs"> and granted access to users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs">`</span></span>
        <span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
        <span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
        <span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
        <span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> unprotectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span><span class="op">;</span></span>
        <span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">protectWithAccess</span>(unprotectedFile)<span class="op">;</span></span>
        <span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <h5 id="revoke-access-1">Revoke Access</h5>
    <p>Let’s say Bob leaves your circle of trust. It’d be great if he no
       longer had access to your sensitive data. Revoke will prevent Bob from
       decrypting your sensitive data:
    </p>
    <!--- SNIPPET revoke.js --->
<div class="sourceCode" id="cb63">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Revoke access</span></span>
        <span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
        <span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
        <span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
        <span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
        <span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
        <span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
        <span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  }</span>
        <span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
        <span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">revokeAccess</span>(protectedFile) {</span>
        <span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
        <span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
        <span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
        <span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
        <span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(params)<span class="op">;</span></span>
        <span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
        <span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// revoke access for user(s)</span></span>
        <span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> users <span class="op">=</span> [<span class="st">&quot;bob@example.com&quot;</span>]<span class="op">;</span></span>
        <span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
        <span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
        <span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">removeUsersWithAccess</span>(users)</span>
        <span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
        <span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
        <span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Revoked access from users: </span><span class="sc">${</span>users<span class="sc">}</span><span class="vs"> on encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span></span>
        <span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
        <span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
        <span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
        <span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
        <span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">revokeAccess</span>(protectedFile)<span class="op">;</span></span>
        <span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>You will still have access to your sensitive data.</p>
    <h5 id="revoke-all-access-1">Revoke All Access</h5>
    <p>Let’s say you landed a new job Alice. Well done! But your circle of
       trust becomes outdated. Rather than removing every Bob from accessing
       your sensitive data, you can remove everyone with revoke all:
    </p>
    <!--- SNIPPET revoke-all.js --->
<div class="sourceCode" id="cb64">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Revoke all access</span></span>
          <span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">revokeAll</span>(protectedFile) {</span>
          <span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">// revoke access for all users</span></span>
          <span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">revokePolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
          <span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Revoked access for all users on encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span></span>
          <span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
          <span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">revokeAll</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>You will still have access to your sensitive data.</p>
    <h5 id="expire-access-1">Expire Access</h5>
    <p>Some things aren’t meant to last. Your landlord, Trent, shouldn’t
       have access to the sensitive data in your lease forever. Let’s make sure
       your sensitive data expires in a year when your lease does:
    </p>
    <!--- SNIPPET expire-relative.js --->
<div class="sourceCode" id="cb65">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Expire access with relative datetime</span></span>
          <span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireRelative</span>(protectedFile) {</span>
          <span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// expire access</span></span>
          <span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> secondsInYear <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">365</span><span class="op">;</span> <span class="co">// min * hour * day * year;</span></span>
          <span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
          <span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableExpirationDeadlineFromNow</span>(secondsInYear)</span>
          <span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
          <span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
          <span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Expire access to encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs"> in </span><span class="sc">${</span>secondsInYear<span class="sc">}</span><span class="vs"> seconds`</span></span>
          <span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
          <span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expireRelative</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>You can also expire at a specific date and time:</p>
    <!--- SNIPPET expire-specific.js --->
<div class="sourceCode" id="cb66">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Expire access with specific datetime</span></span>
        <span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
        <span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
        <span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
        <span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
        <span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
        <span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
        <span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  }</span>
        <span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
        <span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireSpecific</span>(protectedFile) {</span>
        <span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
        <span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
        <span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
        <span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
        <span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
        <span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
        <span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// expire access</span></span>
        <span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> expiresOn <span class="op">=</span> <span class="st">&quot;2022-08-12T14:37:26.101Z&quot;</span><span class="op">;</span> <span class="co">// ISO-8601 Format</span></span>
        <span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
        <span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
        <span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableExpirationDeadline</span>(expiresOn)</span>
        <span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
        <span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
        <span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
        <span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Expire access to encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs"> on </span><span class="sc">${</span>expiresOn<span class="sc">}</span><span class="vs">`</span></span>
        <span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
        <span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>}</span>
        <span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
        <span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
        <span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
        <span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expireSpecific</span>(protectedFile)<span class="op">;</span></span>
        <span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>Expiration prevents everyone else on the policy from decrypting after
       that time. You will still have access.
    </p>
    <p>Make the same expiration calls to update dates or times.</p>
    <p>If you’re feeling permissive, you can always remove expiration
       too:
    </p>
    <!--- SNIPPET expire-disable.js --->
<div class="sourceCode" id="cb67">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Remove access expiration</span></span>
          <span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">expireDisable</span>(protectedFile) {</span>
          <span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// remove access expiration</span></span>
          <span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
          <span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">disableExpirationDeadline</span>()</span>
          <span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
          <span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Removed access expiration on encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
          <span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expireDisable</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <h5 id="watermark-access-1">Watermark Access</h5>
    <p>Trust doesn’t have to be absolute. If you want Bob to access your
       sensitive data, but discourage him from sharing it, you can enable
       watermarking:
    </p>
    <!--- SNIPPET watermark-enable.js --->
<div class="sourceCode" id="cb68">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Enable access watermark</span></span>
          <span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">watermarkEnable</span>(protectedFile) {</span>
          <span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// watermark access</span></span>
          <span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
          <span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enableWatermarking</span>()</span>
          <span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
          <span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
          <span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Enabled watermark when accessing encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span></span>
          <span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
          <span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">watermarkEnable</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
    <p>This option only applies in Virtru’s Secure Reader, where Bob’s email
       address will always overlay the decrypted sensitive data.
    </p>
    <p>To disable watermarking:</p>
    <!--- SNIPPET watermark-disable.js --->
<div class="sourceCode" id="cb69">
  <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Disable access watermark</span></span>
          <span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;virtru-sdk&quot;</span>)<span class="op">;</span></span>
          <span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">loadVirtruClient</span>() {</span>
          <span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_EMAIL</span><span class="op">;</span></span>
          <span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">VIRTRU_SDK_APP_ID</span><span class="op">;</span></span>
          <span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>email <span class="op">||</span> <span class="op">!</span>appId) {</span>
          <span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="st">&quot;An environment variable is not set:</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="sc">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span><span class="op">;</span></span>
          <span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  }</span>
          <span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({ email<span class="op">,</span> appId })<span class="op">;</span></span>
          <span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">watermarkDisable</span>(protectedFile) {</span>
          <span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="fu">loadVirtruClient</span>()<span class="op">;</span></span>
          <span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get policy</span></span>
          <span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">DecryptParamsBuilder</span>()</span>
          <span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(protectedFile)</span>
          <span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> policyId <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">getPolicyId</span>(decryptParams)<span class="op">;</span></span>
          <span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> existingPolicy <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">fetchPolicy</span>(policyId)<span class="op">;</span></span>
          <span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// watermark access</span></span>
          <span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updatedPolicy <span class="op">=</span> existingPolicy</span>
          <span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">builder</span>()</span>
          <span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">disableWatermarking</span>()</span>
          <span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">updatePolicy</span>(updatedPolicy)<span class="op">;</span></span>
          <span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
          <span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`Disabled watermark when accessing encrypted file </span><span class="sc">${</span>protectedFile<span class="sc">}</span><span class="vs">`</span></span>
          <span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
          <span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>}</span>
          <span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="co">// optionally execute from command line</span></span>
          <span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (require<span class="op">.</span><span class="at">main</span> <span class="op">===</span> module) {</span>
          <span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> protectedFile <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span><span class="op">;</span></span>
          <span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">watermarkDisable</span>(protectedFile)<span class="op">;</span></span>
          <span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>}</span>
    </code>
  </pre>
</div>
 </div>
 <!-- End Nodejs sdk wrapper-->
 <!--Python SDK-->
 <div id="python_sdk_wrapper" class="sdk_wrapper">
 <h3 id="virtru-sdk-for-python">Virtru SDK for Python</h3>
 <blockquote>
    <p><a href="https://docs.developer.virtru.com/python/2.1.1/">Python SDK
       Documentation</a>
    </p>
 </blockquote>
 <table>
    <thead>
       <tr class="header">
          <th>Minimum Requirements</th>
       </tr>
    </thead>
    <tbody>
       <tr class="odd">
          <td>Virtru Python SDK requires Python 3.6 or higher.</td>
       </tr>
    </tbody>
 </table>
 <h4 id="quick-start-2">Quick Start</h4>
 <p>You’re Alice and you have sensitive data to protect. (Don’t we
    all?)
 </p>
 <p>Let’s see the fastest way to protect it server-side with the Virtru
    SDK.
 </p>
 <h5 id="prerequisites-2">Prerequisites</h5>
 <ol type="1">
    <li>Linux - Python 3.6, 3.7, 3.8</li>
    <li>macOS - Python 3.7, 3.8</li>
    <li>Windows - Python 3.7, 3.8</li>
 </ol>
 <h5 id="1-install-the-sdk-1">1. Install the SDK</h5>
 <p><a href="https://pypi.org/project/virtru-sdk/">The Virtru Python SDK
    is available on PyPI.</a>
 </p>
 <pre><code>pip3 install virtru-sdk</code></pre>
 <h5 id="2-get-an-identity-1">2. Get an identity</h5>
 <p>So Alice, who should own your sensitive data? You, obviously!</p>
 <p>Authenticate to associate your email address (e.g.
    <code>alice@example.com</code>) with any data you protect. <strong>You
    cannot protect data without authenticating.</strong> If the Virtru
    Platform doesn’t know who’s protecting data, no one would be able to
    access it later (when they’re also asked to authenticate).
 </p>
 <p>The fastest way to authenticate on the server side is with an appId
    token. You can generate one from the <a
       href="https://secure.virtru.com/dashboard#/settings">Virtru
    Dashboard</a>. If you need help, <a
       href="https://developer.virtru.com/docs/how-to-download-appid-token">see
    detailed steps</a>.
 </p>
 <p>For safekeeping, don’t hard code your appID anywhere. A more secure
    option is to store it in your local environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
 <p>To protect your sensitive data, we’ll need a Virtru client. We’ll
    associate anything you encrypt with your email and appId. Let’s make
    sure your email and appId can create a valid Virtru client to make
    further SDK calls:
 </p>
 
 <div class="sourceCode" id="cb72">
    <pre class="sourceCode python">
      <code class="sourceCode python">
        <span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, EncryptFileParams</span>
        <span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
        <span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
        <span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Ready to protect!&quot;</span>)</span>
      </code>
 </pre>
</div>
 <h5 id="3-ask-for-sensitive-data-1">3. Ask for sensitive data</h5>
 <p>Now that we know who will own things, why don’t you enter your first
    piece of sensitive data? For simplicity’s sake, create a file named
    “sensitive.txt” with your sensitive data.
 </p>
 <pre class="shell"><code>touch ./sensitive.txt
 echo &quot;sensitive data&quot; &gt;&gt; ./sensitive.txt</code></pre>
 <h5 id="4-protect-the-sensitive-data-1">4. Protect the sensitive
    data
 </h5>
 <p>Next, <strong>decide your encryption options</strong>. For now, it’s
    the file containing your sensitive data. In the future, this could
    include who else should have access and under what conditions.
 </p>
 <div class="sourceCode" id="cb74">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
        <span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
        <span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
        <span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
      </code>
    </pre>
 </div>
 <p>Finally, encrypt the data:</p>
 <div class="sourceCode" id="cb75">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
 </pre>
 </div>
 <p>Here is the complete source code:</p>
 <div class="sourceCode" id="cb76">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, EncryptFileParams</span>
        <span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
        <span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
        <span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co">#### Specify a file to encrypt and the file name to use for the encrypted output</span></span>
        <span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
        <span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
        <span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
        <span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
        <span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
 </code>
 </pre>
 </div>
 <h5 id="5-access-the-sensitive-data-1">5. Access the sensitive data</h5>
 <p>Now, let’s say you need to see your sensitive data again.
    Authenticate as <code>alice@example.com</code> again and you can decrypt
    the protected file:
 </p>
 <div class="sourceCode" id="cb77">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
          <span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client</span>
          <span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
          <span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
          <span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
          <span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
          <span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
          <span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span></span>
          <span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive_decrypted.txt&quot;</span></span>
          <span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>client.decrypt_file(in_file_path<span class="op">=</span>protected_file,</span>
          <span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>                    out_file_path<span class="op">=</span>unprotected_file)</span>
          <span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Decrypted file </span><span class="sc">{</span>unprotected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
 </code>
 </pre>
 </div>
 <p>The decrypted file should match your original one with the sensitive
    data:
 </p>
 <pre class="shell"><code>diff sensitive.txt sensitive_decrypted.txt</code></pre>
 <h5 id="6-access-the-sensitive-data-anywhere-2">6. Access the sensitive
    data anywhere
 </h5>
 <p>If you inspect the generated HTML file, you still won’t find your
    sensitive data. It stays protected. You can send that HTML file to
    another machine or anywhere you want. Only you will be able to access
    it. But how do you do that outside of this code?
 </p>
 <p>We could build a whole set of functionality to authenticate, decrypt,
    and render files. Or we could <strong>use Virtru’s Secure
    Reader</strong>, which is built to do exactly that for thousands of
    security-conscious users every day. In fact, if you open that HTML file
    from the last step, it will redirect you to Secure Reader.
 </p>
 <p>Secure Reader will ask you to authenticate. (You’re still Alice,
    aren’t you?)
 </p>
 <p><img src=".screenshots/auth.png"
    alt="Authenticating with Virtru Secure Reader" /></p>
 <p>And if you authenticate with the same email address you used to
    create the HTML file, you should be able to view it in Secure
    Reader:
 </p>
 <p><img src=".screenshots/decrypt.png"
    alt="Decrypting with Virtru Secure Reader" /></p>
 <p>Congrats Alice! <strong>Your sensitive data is safe wherever it
    goes</strong>.
 </p>
 <h4 id="authentication-2">Authentication</h4>
 <p>Security starts with identity. You claim you’re Alice, but the Virtru
    SDK doesn’t know that. <strong>We can’t protect or access data without
    an identity that’s responsible for protecting or accessing that
    data</strong>. Otherwise, no one (or anyone) would be able to do
    whatever they want with your data. But we all have sensitive data to
    protect.
 </p>
 <p>So how do you prove your identity to the Virtru SDK? We’re glad you
    asked, “Alice…”
 </p>
 <p>Here are your options on the server-side:</p>
 <ul>
    <li>Use an appId Token from the Virtru Dashboard</li>
    <li>Provision HMAC Token &amp; Secret Pairs</li>
 </ul>
 <hr />
 <h5 id="appid-token-1">appId Token</h5>
 <p>Generate an appId from the <a
    href="https://secure.virtru.com/dashboard#/settings">Virtru
    Dashboard</a>. If you need help, <a
       href="https://developer.virtru.com/docs/how-to-download-appid-token">see
    detailed steps</a>.
 </p>
 <p>Key points about appId authentication:</p>
 <ul>
    <li>appIds expire in 120 days</li>
    <li>appIds are tied to your email address (i.e. your login to Virtru
       Dashboard)
    </li>
    <li>appIds <strong>cannot be used</strong> to encrypt or decrypt data on
       behalf of your app’s end users
    </li>
 </ul>
 <p>For safekeeping, <strong>don’t hard code your appID
    anywhere</strong>. A more secure option is to store it in your local
    environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
 <p>A combination of email &amp; appId can be used to create a Virtru
    client and make all other SDK calls:
 </p>
 <div class="sourceCode" id="cb80">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authentication by AppId Token</span></span>
          <span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
          <span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client</span>
          <span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#### You don&#39;t want your credentials exposed in code.</span></span>
          <span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co">#### In this example, we load credentials from environment variables</span></span>
          <span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
          <span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
          <span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
          <span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
          <span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co">#### the `client` can now be used to encrypt/decrypt data.</span></span>
          <span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Ready to protect!&quot;</span>)</span>
 </code>
 </pre>
 </div>
 <hr />
 <h5 id="hmac-token--secret-pairs-1">HMAC Token &amp; Secret Pairs</h5>
 <p>HMAC authentication is a long-lived alternative to appIds.</p>
 <p>Key points about HMAC authentication:</p>
 <ul>
    <li>HMAC does not expire</li>
    <li>HMAC is tied to your domain</li>
    <li>HMAC <strong>can only be used</strong> to encrypt or decrypt data on
       behalf of your <strong>domain’s</strong> users
    </li>
 </ul>
 <p>Thus, Virtru must provision an HMAC token &amp; secret pair. <a
    href="https://www.virtru.com/contact-us/">Contact Virtru for HMAC
    provisioning</a>.
 </p>
 <p>If you provision an HMAC token &amp; secret pair for example.com,
    <code>bob@example.com</code> can use your server-side app to encrypt his
    data and control who has access. A different domain, such as
    <code>bob@elsewhere.com</code> will not be able to encrypt or decrypt
    data with your server-side app. Emails in other domains would need to
    use a client-side app or Secure Reader to access the same data.
 </p>
 <p>For safekeeping, <strong>don’t hard code your HMAC token &amp; secret
    pair anywhere</strong>. A more secure option would be to store them in
    your local environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_HMAC_TOKEN=[paste from Virtru provisioning email]
 export VIRTRU_SDK_HMAC_APP_SECRET=[paste from Virtru provisioning email]</code></pre>
 <p>The HMAC token &amp; secret pair can be used to create a Virtru
    client and make all other SDK calls:
 </p>
 <div class="sourceCode" id="cb82">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authentication by HMAC Token &amp; Secret</span></span>
          <span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
          <span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client</span>
          <span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co">#### You don&#39;t want your credentials exposed in code.</span></span>
          <span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">#### In this example, we load credentials from environment variables</span></span>
          <span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
          <span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_HMAC_TOKEN <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_HMAC_TOKEN&quot;</span>)</span>
          <span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_HMAC_APP_SECRET <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_HMAC_APP_SECRET&quot;</span>)</span>
          <span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_HMAC_TOKEN <span class="kw">and</span> VIRTRU_SDK_HMAC_APP_SECRET):</span>
          <span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&#39;&#39;&#39;An environment variable is not set:</span></span>
          <span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="st">- VIRTRU_SDK_EMAIL</span></span>
          <span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="st">- VIRTRU_SDK_HMAC_TOKEN</span></span>
          <span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="st">- VIRTRU_SDK_HMAC_APP_SECRET&#39;&#39;&#39;</span>)</span>
          <span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
          <span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL,</span>
          <span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                api_key<span class="op">=</span>VIRTRU_SDK_HMAC_TOKEN,</span>
          <span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                secret<span class="op">=</span>VIRTRU_SDK_HMAC_APP_SECRET)</span>
          <span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="co">#### the `client` can now be used to encrypt/decrypt data.</span></span>
          <span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Ready to protect!&quot;</span>)</span>
 </code>
 </pre>
 </div>
 <hr />
 <h4 id="encrypt-2">Encrypt</h4>
 <p>Now that the Virtru SDK knows you’re Alice, you can protect your
    first piece of data.
 </p>
 <h5 id="encryption-basics-2">Encryption Basics</h5>
 <p>Before calling encrypt, you need to specify a few simple
    parameters.
 </p>
 <p>You don’t need to include your email address when encrypting. You
    will already have access to anything you encrypt because you
    authenticated. But if you want anyone else to have access (like another
    one of your emails, <code>alice@nowhere.com</code>), you could include
    them here:
 </p>
 <div class="sourceCode" id="cb83">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
          <span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
          <span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
          <span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
          <span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
          <span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
          <span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
      </code>
 </pre>
 </div>
 <p>Call encrypt and check out the resulting file:</p>
 <div class="sourceCode" id="cb84">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <p>Here's the complete source code:</p>
 <div class="sourceCode" id="cb85">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Encryption example - HTML format</span></span>
          <span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
          <span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy, EncryptFileParams</span>
          <span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
          <span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
          <span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
          <span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
          <span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
          <span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#### Create a default policy and share</span></span>
          <span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
          <span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
          <span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
          <span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
          <span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
          <span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
          <span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
          <span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="co">#### Encrypt</span></span>
          <span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
          <span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
    </pre>
</div>
 <p>Now, your sensitive data is safe. Keep reading to see how or access
    your data by decrypting.
 </p>
 <hr />
 <h5 id="encryption-lifecycle-2">Encryption Lifecycle</h5>
 <p>That one little encrypt call did a lot of work behind the scenes to
    keep your sensitive data safe:
 </p>
 <p><img src=".screenshots/lifecycle.png"
    alt="Protecting a file and sending the policy and key materials to Virtru" /></p>
 <ul>
    <li>
       <p><strong>Step 1</strong>: Your app authenticates with Virtru's
          entity service.
       </p>
       <p><em>This was when you proved you were
          <code>alice@example.com</code>.</em>
       </p>
    </li>
    <li>
       <p><strong>Step 2</strong>: Then, an encrypt call protects any given
          data as ciphertext. This ciphertext is local to where encrypt was called
          (a browser, end user device, or server). Although encrypt uses the open
          Trusted Data Format (TDF), you can save the ciphertext in a file format
          that you can open anywhere—HTML.
       </p>
       <p><em>This was when your sensitive data became protected.</em></p>
    </li>
    <li>
       <p><strong>Step 3</strong>: While an encrypt call keeps the
          protected data as local ciphertext, a secure decryption key travels back
          to Virtru’s key server for safe-keeping. But this key server doesn’t
          hand out keys to anyone…
       </p>
       <p><em>This is why you don’t have to manage keys yourself.</em></p>
    </li>
    <li>
       <p><strong>Step 4</strong>: While an encrypt call keeps the
          protected data as local ciphertext, the SDK saves the access controls
          for the protected data in Virtru’s access server. The access server
          determines if a particular authenticated user (Step 1) can access
          protected data (Step 2) using a decryption key (Step 3).
       </p>
       <p><em>This is the crucial backend you don’t have to build or host.
          <strong>It never has access to your local data.</strong></em>
       </p>
    </li>
 </ul>
 <hr />
 <h5 id="encrypted-file-formats-2">Encrypted File Formats</h5>
 <p>We generated a <code>.tdf.html</code> file above. This is the SDK
    default, but not the only option.
 </p>
 <table>
    <thead>
       <tr class="header">
          <th></th>
          <th>HTML Format</th>
          <th>ZIP Format</th>
       </tr>
    </thead>
    <tbody>
       <tr class="odd">
          <td>File Extension</td>
          <td>.tdf.html</td>
          <td>.tdf</td>
       </tr>
       <tr class="even">
          <td>File Size</td>
          <td>File sizes less than 100 MB</td>
          <td>Any file size</td>
       </tr>
       <tr class="odd">
          <td>Decryption</td>
          <td>Any Virtru SDK</td>
          <td>Any Virtru SDK</td>
       </tr>
       <tr class="even">
          <td>User Experience</td>
          <td>Open file anywhere to redirect to Virtru's Secure Reader</td>
          <td>Drag &amp; drop in Virtru's Secure Reader</td>
       </tr>
    </tbody>
 </table>
 <p>If you need a protected ZIP file, add it to the encrypt params:</p>
 <div class="sourceCode" id="cb86">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Protocol</span>
          <span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">#### …</span></span>
          <span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>client.set_protocol(Protocol.Zip)  <span class="co"># generates ZIP instead of HTML</span></span>
      </code>
   </pre>
 </div>
 <p>Here's the complete source code:</p>
 <div class="sourceCode" id="cb87">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Encryption example - ZIP format</span></span>
        <span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy, EncryptFileParams, Protocol</span>
        <span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
        <span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
        <span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co">#### Create a default policy and share</span></span>
        <span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;alice@nowhere.com&quot;</span>])</span>
        <span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
        <span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf&quot;</span></span>
        <span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
        <span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
        <span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
        <span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="co">#### Encrypt</span></span>
        <span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>client.set_protocol(Protocol.Zip)  <span class="co"># generates ZIP instead of HTML</span></span>
        <span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
  </pre>
</div>
 
<p>And you’ll have a ZIP file with the same level of protection as HTML,
    but the caveats in the table above.
 </p>
 <h4 id="decrypt-2">Decrypt</h4>
 <p>Well Alice, the good news is, your first encrypted file is so safe,
    only you can decrypt it. Let’s confirm that with your protected file.
    Then, we’ll grant access to someone you trust.
 </p>
 <h5 id="meet-secure-reader-the-easiest-way-to-decrypt-2">Meet Secure
    Reader, the easiest way to decrypt
 </h5>
 <p>Opening a protected HTML file will take you to Virtru’s Secure
    Reader.
 </p>
 <p><img src=".screenshots/auth.png"
    alt="Authenticating with Virtru Secure Reader" /></p>
 <p>Secure Reader will also ask you to authenticate. Again, no one trusts
    that you’re Alice. But trust us, it’s good for security. If Mallory
    tries to authenticate, he won’t see your sensitive data.
 </p>
 <p>But if you authenticate, Secure Reader will render your file.</p>
 <p><img src=".screenshots/decrypt.png"
    alt="Decrypting with Virtru Secure Reader" /></p>
 <p>If Secure Reader can’t render the file, you will still be able to
    download it.
 </p>
 <h5 id="decrypting-via-sdk-2">Decrypting via SDK</h5>
 <p>Outside of Secure Reader, you can also decrypt a file via the
    SDK:
 </p>
 <div class="sourceCode" id="cb88">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Decryption example</span></span>
        <span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client</span>
        <span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load email and appId from environment variables</span></span>
        <span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#### Authenticate</span></span>
        <span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#### Decrypt</span></span>
        <span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt.tdf.html&quot;</span></span>
        <span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive_decrypted.txt&quot;</span></span>
        <span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>client.decrypt_file(in_file_path<span class="op">=</span>protected_file,</span>
        <span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>                    out_file_path<span class="op">=</span>unprotected_file)</span>
        <span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Decrypted file </span><span class="sc">{</span>unprotected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <h5 id="allowing-others-to-decrypt-2">Allowing others to decrypt</h5>
 <p>But let’s say you wanted to share your sensitive data with your
    trusted colleague Bob, whose email is <code>bob@example.com</code>.
 </p>
 <p>For existing files, you would grant access to
    <code>bob@example.com</code> and save the changes to the Virtru
    Platform.
 </p>
 <div class="sourceCode" id="cb89">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;bob@example.com&quot;</span>])</span>
        <span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
      </code>
  </pre>
</div>
 <p>Now, <code>bob@example.com</code> should be able to view your
    sensitive data in Secure Reader (anywhere) or via the SDK decrypt call
    (in your apps).
 </p>
 <p>When protecting new files, you can grant access to Bob or any number
    of users as part of encryption params:
 </p>
 <div class="sourceCode" id="cb90">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;bob@example.com&quot;</span>])</span>
        <span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">#### encrypt the file with the new policy</span></span>
        <span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span><span class="st">&quot;sensitive.txt&quot;</span>,</span>
        <span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                         out_file_path<span class="op">=</span><span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
        <span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
        <span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
      </code>
    </pre>
 </div>
 
 <h3 id="access-control-2">Access Control</h3>
 <p>No one can predict the future. Access controls let you change your
    mind about who has access and under what conditions.
 </p>
 <h5 id="grant-access-2">Grant Access</h5>
 <p>Let’s say Bob enters your circle of trust. If you grant him access,
    he can decrypt your sensitive data.
 </p>
 <div class="sourceCode" id="cb91">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Grant for existing policy</span></span>
        <span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy</span>
        <span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Update policy to grant access to a user</span></span>
        <span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;bob@example.com&quot;</span>])  <span class="co"># can also decrypt</span></span>
        <span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <p>You can also grant access before you encrypt:</p>
 <div class="sourceCode" id="cb92">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Grant with new policy</span></span>
        <span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy, EncryptFileParams</span>
        <span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a policy to grant access to a user</span></span>
        <span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>policy.share_with_users([<span class="st">&quot;bob@example.com&quot;</span>])</span>
        <span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;sensitive.txt&quot;</span></span>
        <span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
        <span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
        <span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
        <span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
        <span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Encrypt</span></span>
        <span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <h5 id="revoke-access-2">Revoke Access</h5>
 <p>Let’s say Bob leaves your circle of trust. It’d be great if he no
    longer had access to your sensitive data. Revoke will prevent Bob from
    decrypting your sensitive data:
 </p>
 <div class="sourceCode" id="cb93">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Revoke</span></span>
        <span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy</span>
        <span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Update policy to revoke access</span></span>
        <span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>policy.remove_users([<span class="st">&#39;bob@example.com&#39;</span>])  <span class="co"># can no longer decrypt, but you still can</span></span>
        <span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <p>You will still have access to your sensitive data.</p>
 <h5 id="revoke-all-access-2">Revoke All Access</h5>
 <p>Let’s say you landed a new job Alice. Well done! But your circle of
    trust becomes outdated. Rather than removing every Bob from accessing
    your sensitive data, you can remove everyone with revoke all:
 </p>
 <div class="sourceCode" id="cb94">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Revoke all</span></span>
        <span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client</span>
        <span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Revoke access for everyone else, only you can decrypt</span></span>
        <span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>client.revoke_file(<span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
      </code>
    </pre>
 </div>
 
 <p>You will still have access to your sensitive data.</p>
 <h5 id="expire-access-2">Expire Access</h5>
 <p>Some things aren’t meant to last. Your landlord, Trent, shouldn’t
    have access to the sensitive data in your lease forever. Let’s make sure
    your sensitive data expires in a year when your lease does:
 </p>
 <div class="sourceCode" id="cb95">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Expire relative to now</span></span>
        <span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy, EncryptFileParams</span>
        <span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create policy with expiration</span></span>
        <span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>policy.expire_in_days(days<span class="op">=</span><span class="dv">365</span>)</span>
        <span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Encrypt with policy</span></span>
        <span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;lease.docx&quot;</span></span>
        <span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
        <span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
        <span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
        <span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
        <span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
        <span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
      </code>
    </pre>
 </div>
 
 <p>You can also expire at a specific date and time:</p>
 <div class="sourceCode" id="cb96">
    <pre class="sourceCode python">
       <code class="sourceCode python">
         <span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Expire at specific time</span></span>
          <span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
          <span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy, EncryptFileParams </span>
          <span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
          <span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
          <span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
          <span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
          <span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
          <span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
          <span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create policy with expiration</span></span>
          <span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
          <span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>policy.add_expiration(<span class="st">&quot;2022-08-12T14:37:26.101Z&quot;</span>)  <span class="co"># ISO-8601 Format</span></span>
          <span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Encrypt with policy</span></span>
          <span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>unprotected_file <span class="op">=</span> <span class="st">&quot;lease.docx&quot;</span></span>
          <span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>protected_file <span class="op">=</span> unprotected_file <span class="op">+</span> <span class="st">&quot;.tdf.html&quot;</span></span>
          <span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>param <span class="op">=</span> EncryptFileParams(in_file_path<span class="op">=</span>unprotected_file,</span>
          <span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>                          out_file_path<span class="op">=</span>protected_file)</span>
          <span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>param.set_policy(policy)</span>
          <span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>client.encrypt_file(encrypt_file_params<span class="op">=</span>param)</span>
          <span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Encrypted file </span><span class="sc">{</span>protected_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
        </code>
    </pre>
 </div>
 <p>Expiration prevents everyone else on the policy from decrypting after
    that time. You will still have access.
 </p>
 <p>Make the same expiration calls to update dates or times.</p>
 <p>If you’re feeling permissive, you can always remove expiration
    too:
 </p>
 <div class="sourceCode" id="cb97">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Remove expiration</span></span>
        <span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy</span>
        <span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Update policy expiration</span></span>
        <span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>policy.remove_expiration()</span>
        <span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;lease.docx.tdf.html&quot;</span>)</span>
      </code>
    </pre>
 </div>
 
 <h5 id="watermark-access-2">Watermark Access</h5>
 <p>Trust doesn’t have to be absolute. If you want Bob to access your
    sensitive data, but discourage him from sharing it, you can enable
    watermarking:
 </p>
 <div class="sourceCode" id="cb98">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python Access Controls - Watermark</span></span>
        <span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
        <span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> virtru_sdk <span class="im">import</span> Client, Policy</span>
        <span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load email and appId from environment variables</span></span>
        <span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_EMAIL <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_EMAIL&quot;</span>)</span>
        <span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>VIRTRU_SDK_APP_ID <span class="op">=</span> os.getenv(<span class="st">&quot;VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> (VIRTRU_SDK_EMAIL <span class="kw">and</span> VIRTRU_SDK_APP_ID):</span>
        <span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">EnvironmentError</span>(<span class="st">&quot;An environment variable is not set:</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_EMAIL</span><span class="ch">\n</span><span class="st">- VIRTRU_SDK_APP_ID&quot;</span>)</span>
        <span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Authenticate</span></span>
        <span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(owner<span class="op">=</span>VIRTRU_SDK_EMAIL, app_id<span class="op">=</span>VIRTRU_SDK_APP_ID)</span>
        <span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
        <span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Update policy watermark</span></span>
        <span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
        <span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>policy.enable_watermarking()  <span class="co"># or policy.disable_watermarking()</span></span>
        <span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
      </code>
    </pre>
 </div>
 <p>This option only applies in Virtru’s Secure Reader, where Bob’s email
    address will always overlay the decrypted sensitive data.
 </p>
 <p>To disable watermarking:</p>
 <div class="sourceCode" id="cb99">
    <pre class="sourceCode python">
       <code class="sourceCode python">
        <span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>policy <span class="op">=</span> Policy()</span>
 <span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>policy.disable_watermarking()</span>
 <span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>client.update_policy_for_file(policy, <span class="st">&quot;sensitive.txt.tdf.html&quot;</span>)</span>
 </code>
 </pre>
 </div>
 </div> <!-- end Python SDK Wrapper-->
 <!--C++ SDK-->
 <div id="js_sdk_wrapper" class="sdk_wrapper">
 <h3 id="virtru-sdk-for-c">Virtru SDK for C++</h3>
 <blockquote>
    <p><a href="https://docs.developer.virtru.com/cpp/2.1.1/">C++ SDK
       Documentation</a>
    </p>
 </blockquote>
 <h4 id="quick-start-3">Quick Start</h4>
 <p>You’re Alice and you have sensitive data to protect. (Don’t we
    all?)
 </p>
 <p>Let’s see the fastest way to protect it server-side with the Virtru
    SDK.
 </p>
 <h5 id="prerequisites-3">Prerequisites</h5>
 <ul>
    <li>
       Compiler compatible with C++17 or newer:
       <ul>
          <li>Linux: gcc 7.40</li>
          <li>macOS: XCode 11.3</li>
          <li>Windows: Microsoft Visual Studio 2017</li>
       </ul>
    </li>
    <li><a href="https://cmake.org">CMake</a> (Linux, macOS, Windows)</li>
 </ul>
 <h5 id="1-install-the-sdk-2">1. Install the SDK</h5>
 <h6 id="linux">Linux</h6>
 <ol type="1">
    <li>Download the <a
       href="https://sdk.virtru.com/cpp/2.1.1/virtru-tdf3-lib-cpp-lin.tar.gz">C++
       archive for Linux</a>.
    </li>
    <li>Unpack the archive.</li>
    <li>Move the unpacked folder into your project.</li>
    <li>Generate project files:</li>
 </ol>
 <pre class="shell"><code>cd ./sample # from downloaded archive
 cmake -G &quot;Eclipse CDT4 - Unix Makefiles&quot;
 make # compile, link, and create an executable</code></pre>
 <h6 id="macos">macOS</h6>
 <ol type="1">
    <li>Download the <a
       href="https://sdk.virtru.com/cpp/2.1.1/virtru-tdf3-lib-cpp-osx.tar.gz">C++
       archive for macOS</a>.
    </li>
    <li>Unpack the archive.</li>
    <li>Move the unpacked folder into your project.</li>
    <li>Generate project files:</li>
 </ol>
 <pre class="shell"><code>cd ./sample # from downloaded archive
 cmake .
 make # compile, link, and create an executable</code></pre>
 <h6 id="windows">Windows</h6>
 <ol type="1">
    <li>Download the <a
       href="https://sdk.virtru.com/cpp/2.1.1/virtru-tdf3-lib-cpp-win.zip">C++
       archive for Windows</a>.
    </li>
    <li>Unpack the archive.</li>
    <li>Move the unpacked folder into your project.</li>
    <li>Install Visual Studio 2017 or newer.</li>
    <li>Generate Visual Studio project files using CMake. Run this in the
       Developer PowerShell for Visual Studio:
    </li>
 </ol>
 <div class="sourceCode" id="cb102">
    <pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Set-Location</span> <span class="op">.</span>\sample\</span>
 <span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>cmake <span class="op">-</span>G <span class="st">&quot;Visual Studio 15 2017 Win64&quot;</span></span>
 </code>
 </pre>
 </div>
 <ol start="6" type="1">
    <li>Open the <code>virtru_tdf3_sensitive.sln</code> file with Visual
       Studio.
    </li>
    <li>Select <code>Release</code> in configuration.</li>
    <li>Select <code>Build &gt; Build solution</code> to compile, link and
       create an executable.
    </li>
 </ol>
 <h5 id="2-get-an-identity-2">2. Get an identity</h5>
 <p>So Alice, who should own your sensitive data? You, obviously!</p>
 <p>Authenticate to associate your email address (e.g.
    <code>alice@example.com</code>) with any data you protect. <strong>You
    cannot protect data without authenticating.</strong> If the Virtru
    Platform doesn’t know who’s protecting data, no one would be able to
    access it later (when they’re also asked to authenticate).
 </p>
 <p>The fastest way to authenticate on the server side is with an appId
    token. You can generate one from the <a
       href="https://secure.virtru.com/dashboard#/settings">Virtru
    Dashboard</a>. If you need help, <a
       href="/docs/how-to-download-appid-token">see detailed steps</a>.
 </p>
 <p>For safekeeping, don’t hard code your appID anywhere. A more secure
    option is to store it in your local environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
 <p>To protect your sensitive data, we’ll need a Virtru client. We’ll
    associate anything you encrypt with your email and appId. Let’s make
    sure your email and appId can create a valid Virtru client to make
    further SDK calls:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     std::cout &lt;&lt; &quot;Ready to protect!&quot; &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <h5 id="3-ask-for-sensitive-data-2">3. Ask for sensitive data</h5>
 <p>Now that we know who will own things, why don’t you enter your first
    piece of sensitive data? For simplicity’s sake, create a file named
    “sensitive.txt” with your sensitive data.
 </p>
 <pre class="shell"><code>touch ./sensitive.txt
 echo &quot;sensitive data&quot; &gt;&gt; ./sensitive.txt</code></pre>
 <h5 id="4-protect-the-sensitive-data-2">4. Protect the sensitive
    data
 </h5>
 <p>Next, <strong>decide your encryption options</strong>. For now, it’s
    the file containing your sensitive data. In the future, this could
    include who else should have access and under what conditions.
 </p>
 <pre class="cplusplus"><code>std::string unprotectedFile = &quot;sensitive.txt&quot;;
 std::string protectedFile = unprotectedFile + &quot;.tdf.html&quot;;
 EncryptFileParams params {unprotectedFile, protectedFile};</code></pre>
 <p>Finally, encrypt the data:</p>
 <pre class="cplusplus"><code>client.encryptFile(params);</code></pre>
 <p>Here is the complete source code:</p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     std::string unprotectedFile = &quot;sensitive.txt&quot;;
     std::string protectedFile = unprotectedFile + &quot;.tdf.html&quot;;
     EncryptFileParams params {unprotectedFile, protectedFile};
 
     client.encryptFile(params);
     std::cout &lt;&lt; &quot;Encrypted file &quot; &lt;&lt; protectedFile &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <h5 id="5-access-the-sensitive-data-2">5. Access the sensitive data</h5>
 <p>Now, let’s say you need to see your sensitive data again.
    Authenticate as <code>alice@example.com</code> again and you can decrypt
    the protected file:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     std::string protectedFile = &quot;sensitive.txt.tdf.html&quot;;
     std::string unprotectedFile = &quot;sensitive_decrypted.txt&quot;;
     client.decryptFile(protectedFile, unprotectedFile);
 
     std::cout &lt;&lt; &quot;Decrypted file &quot; &lt;&lt; unprotectedFile &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <p>The decrypted file should match your original one with the sensitive
    data:
 </p>
 <pre class="shell"><code>diff sensitive.txt sensitive_decrypted.txt</code></pre>
 <h5 id="6-access-the-sensitive-data-anywhere-3">6. Access the sensitive
    data anywhere
 </h5>
 <p>If you inspect the generated HTML file, you still won’t find your
    sensitive data. It stays protected. You can send that HTML file to
    another machine or anywhere you want. Only you will be able to access
    it. But how do you do that outside of this code?
 </p>
 <p>We could build a whole set of functionality to authenticate, decrypt,
    and render files. Or we could <strong>use Virtru’s Secure
    Reader</strong>, which is built to do exactly that for thousands of
    security-conscious users every day. In fact, if you open that HTML file
    from the last step, it will redirect you to Secure Reader.
 </p>
 <p>Secure Reader will ask you to authenticate. (You’re still Alice,
    aren’t you?)
 </p>
 <p><img src=".screenshots/auth.png"
    alt="Authenticating with Virtru Secure Reader" /></p>
 <p>And if you authenticate with the same email address you used to
    create the HTML file, you should be able to view it in Secure
    Reader:
 </p>
 <p><img src=".screenshots/decrypt.png"
    alt="Decrypting with Virtru Secure Reader" /></p>
 <p>Congrats Alice! <strong>Your sensitive data is safe wherever it
    goes</strong>.
 </p>
 <h4 id="authentication-3">Authentication</h4>
 <p>Security starts with identity. You claim you’re Alice, but the Virtru
    SDK doesn’t know that. <strong>We can’t protect or access data without
    an identity that’s responsible for protecting or accessing that
    data</strong>. Otherwise, no one (or anyone) would be able to do
    whatever they want with your data. But we all have sensitive data to
    protect.
 </p>
 <p>So how do you prove your identity to the Virtru SDK? We’re glad you
    asked, “Alice…”
 </p>
 <p>Here are your options on the server-side:</p>
 <ul>
    <li>Use an appId Token from the Virtru Dashboard</li>
    <li>Provision HMAC Token &amp; Secret Pairs</li>
 </ul>
 <hr />
 <h5 id="appid-token-2">appId Token</h5>
 <p>Generate an appId from the <a
    href="https://secure.virtru.com/dashboard#/settings">Virtru
    Dashboard</a>. If you need help, <a
       href="https://developer.virtru.com/docs/how-to-download-appid-token">see
    detailed steps</a>.
 </p>
 <p>Key points about appId authentication:</p>
 <ul>
    <li>appIds expire in 120 days</li>
    <li>appIds are tied to your email address (i.e. your login to Virtru
       Dashboard)
    </li>
    <li>appIds <strong>cannot be used</strong> to encrypt or decrypt data on
       behalf of your app’s end users
    </li>
 </ul>
 <p>For safekeeping, <strong>don’t hard code your appID
    anywhere</strong>. A more secure option is to store it in your local
    environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_APP_ID=[paste from Virtru Dashboard]</code></pre>
 <p>A combination of email &amp; appId can be used to create a Virtru
    client and make all other SDK calls:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     std::cout &lt;&lt; &quot;Ready to protect!&quot; &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <hr />
 <h5 id="hmac-token--secret-pairs-2">HMAC Token &amp; Secret Pairs</h5>
 <p>HMAC authentication is a long-lived alternative to appIds.</p>
 <p>Key points about HMAC authentication:</p>
 <ul>
    <li>HMAC does not expire</li>
    <li>HMAC is tied to your domain</li>
    <li>HMAC <strong>can only be used</strong> to encrypt or decrypt data on
       behalf of your <strong>domain’s</strong> users
    </li>
 </ul>
 <p>Thus, Virtru must provision an HMAC token &amp; secret pair. <a
    href="https://www.virtru.com/contact-us/">Contact Virtru for HMAC
    provisioning</a>.
 </p>
 <p>If you provision an HMAC token &amp; secret pair for example.com,
    <code>bob@example.com</code> can use your server-side app to encrypt his
    data and control who has access. A different domain, such as
    <code>bob@elsewhere.com</code> will not be able to encrypt or decrypt
    data with your server-side app. Emails in other domains would need to
    use a client-side app or Secure Reader to access the same data.
 </p>
 <p>For safekeeping, <strong>don’t hard code your HMAC token &amp; secret
    pair anywhere</strong>. A more secure option would be to store them in
    your local environment:
 </p>
 <pre class="shell"><code>export VIRTRU_SDK_EMAIL=[paste from Virtru Dashboard]
 export VIRTRU_SDK_HMAC_TOKEN=[paste from Virtru provisioning email]
 export VIRTRU_SDK_HMAC_APP_SECRET=[paste from Virtru provisioning email]</code></pre>
 <p>The HMAC token &amp; secret pair can be used to create a Virtru
    client and make all other SDK calls:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto hmacToken = std::getenv(&quot;VIRTRU_SDK_HMAC_TOKEN&quot;);
     auto hmacSecret = std::getenv(&quot;VIRTRU_SDK_HMAC_APP_SECRET&quot;);
     if (email == nullptr || hmacToken == nullptr || hmacSecret == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_HMAC_TOKEN\n- VIRTRU_SDK_HMAC_APP_SECRET&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, hmacToken, hmacSecret};
 
     std::cout &lt;&lt; &quot;Ready to protect!&quot; &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <hr />
 <h4 id="encrypt-3">Encrypt</h4>
 <p>Now that the Virtru SDK knows you’re Alice, you can protect your
    first piece of data.
 </p>
 <h5 id="encryption-basics-3">Encryption Basics</h5>
 <p>Before calling encrypt, you need to specify a few simple
    parameters.
 </p>
 <p>You don’t need to include your email address when encrypting. You
    will already have access to anything you encrypt because you
    authenticated. But if you want anyone else to have access (like another
    one of your emails, <code>alice@nowhere.com</code>), you could include
    them here:
 </p>
 <pre class="cplusplus"><code>Policy policy;
 policy.shareWithUsers({&quot;alice@nowhere.com&quot;});
 std::string unprotectedFile = &quot;sensitive.docx&quot;;
 std::string protectedFile = unprotectedFile + &quot;.tdf.html&quot;;
 EncryptFileParams params {unprotectedFile, protectedFile};
 params.setPolicy(policy);</code></pre>
 <p>Call encrypt and check out the resulting file:</p>
 <pre class="cplusplus"><code>client.encryptFile(params);
 std::cout &lt;&lt; &quot;Encrypted file &quot; &lt;&lt; protectedFile &lt;&lt; std::endl;</code></pre>
 <p>Here's the complete source code:</p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.shareWithUsers({&quot;alice@nowhere.com&quot;});
     std::string unprotectedFile = &quot;sensitive.docx&quot;;
     std::string protectedFile = unprotectedFile + &quot;.tdf.html&quot;;
     EncryptFileParams params {unprotectedFile, protectedFile};
     params.setPolicy(policy);
 
     client.encryptFile(params);
     std::cout &lt;&lt; &quot;Encrypted file &quot; &lt;&lt; protectedFile &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <p>Now, your sensitive data is safe. Keep reading to see how to access
    your data by decrypting.
 </p>
 <hr />
 <h5 id="encryption-lifecycle-3">Encryption Lifecycle</h5>
 <p>That one little encrypt call did a lot of work behind the scenes to
    keep your sensitive data safe:
 </p>
 <p><img src=".screenshots/lifecycle.png"
    alt="Protecting a file and sending the policy and key materials to Virtru" /></p>
 <ul>
    <li>
       <p><strong>Step 1</strong>: Your app authenticates with Virtru's
          entity service.
       </p>
       <p><em>This was when you proved you were
          <code>alice@example.com</code>.</em>
       </p>
    </li>
    <li>
       <p><strong>Step 2</strong>: Then, an encrypt call protects any given
          data as ciphertext. This ciphertext is local to where encrypt was called
          (a browser, end user device, or server). Although encrypt uses the open
          Trusted Data Format (TDF), you can save the ciphertext in a file format
          that you can open anywhere—HTML.
       </p>
       <p><em>This was when your sensitive data became protected.</em></p>
    </li>
    <li>
       <p><strong>Step 3</strong>: While an encrypt call keeps the
          protected data as local ciphertext, a secure decryption key travels back
          to Virtru’s key server for safe-keeping. But this key server doesn’t
          hand out keys to anyone…
       </p>
       <p><em>This is why you don’t have to manage keys yourself.</em></p>
    </li>
    <li>
       <p><strong>Step 4</strong>: While an encrypt call keeps the
          protected data as local ciphertext, the SDK saves the access controls
          for the protected data in Virtru’s access server. The access server
          determines if a particular authenticated user (Step 1) can access
          protected data (Step 2) using a decryption key (Step 3).
       </p>
       <p><em>This is the crucial backend you don’t have to build or host.
          <strong>It never has access to your local data.</strong></em>
       </p>
    </li>
 </ul>
 <hr />
 <h5 id="encrypted-file-formats-3">Encrypted File Formats</h5>
 <p>We generated a <code>.tdf.html</code> file above. This is the SDK
    default, but not the only option.
 </p>
 <table>
    <thead>
       <tr class="header">
          <th></th>
          <th>HTML Format</th>
          <th>ZIP Format</th>
       </tr>
    </thead>
    <tbody>
       <tr class="odd">
          <td>File Extension</td>
          <td>.tdf.html</td>
          <td>.tdf</td>
       </tr>
       <tr class="even">
          <td>File Size</td>
          <td>File sizes less than 100 MB</td>
          <td>Any file size</td>
       </tr>
       <tr class="odd">
          <td>Decryption</td>
          <td>Any Virtru SDK</td>
          <td>Any Virtru SDK</td>
       </tr>
       <tr class="even">
          <td>User Experience</td>
          <td>Open file anywhere to redirect to Virtru's Secure Reader</td>
          <td>Drag &amp; drop in Virtru's Secure Reader</td>
       </tr>
    </tbody>
 </table>
 <p>If you need a protected ZIP file, add it to the encrypt params:</p>
 <pre class="cplusplus"><code>client.setProtocol(Protocol::Zip); // generates ZIP instead of HTML</code></pre>
 <p>Here's the complete source code:</p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.shareWithUsers({&quot;alice@nowhere.com&quot;});
     std::string unprotectedFile = &quot;sensitive.docx&quot;;
     std::string protectedFile = unprotectedFile + &quot;.tdf&quot;;
     EncryptFileParams params {unprotectedFile, protectedFile};
     params.setPolicy(policy);
 
     client.setProtocol(Protocol::Zip); // generates ZIP instead of HTML
     client.encryptFile(params);
     std::cout &lt;&lt; &quot;Encrypted file &quot; &lt;&lt; protectedFile &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <p>And you’ll have a ZIP file with the same level of protection as HTML,
    but the caveats in the table above.
 </p>
 <h4 id="decrypt-3">Decrypt</h4>
 <p>Well Alice, the good news is, your first encrypted file is so safe,
    only you can decrypt it. Let’s confirm that with your protected file.
    Then, we’ll grant access to someone you trust.
 </p>
 <h5 id="meet-secure-reader-the-easiest-way-to-decrypt-3">Meet Secure
    Reader, the easiest way to decrypt
 </h5>
 <p>Opening a protected HTML file will take you to Virtru’s Secure
    Reader.
 </p>
 <p><img src=".screenshots/auth.png"
    alt="Authenticating with Virtru Secure Reader" /></p>
 <p>Secure Reader will also ask you to authenticate. Again, no one trusts
    that you’re Alice. But trust us, it’s good for security. If Mallory
    tries to authenticate, he won’t see your sensitive data.
 </p>
 <p>But if you authenticate, Secure Reader will render your file.</p>
 <p><img src=".screenshots/decrypt.png"
    alt="Decrypting with Virtru Secure Reader" /></p>
 <p>If Secure Reader can’t render the file, you will still be able to
    download it.
 </p>
 <h5 id="decrypting-via-sdk-3">Decrypting via SDK</h5>
 <p>Outside of Secure Reader, you can also decrypt a file via the
    SDK:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 #include &lt;iostream&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     std::string protectedFile = &quot;sensitive.docx.tdf.html&quot;;
     std::string unprotectedFile = &quot;sensitive_decrypted.docx&quot;;
     client.decryptFile(protectedFile, unprotectedFile);
 
     std::cout &lt;&lt; &quot;Decrypted file &quot; &lt;&lt; unprotectedFile &lt;&lt; std::endl;
     return EXIT_SUCCESS;
 }</code></pre>
 <h5 id="allowing-others-to-decrypt-3">Allowing others to decrypt</h5>
 <p>But let’s say you wanted to share your sensitive data with your
    trusted colleague Bob, whose email is <code>bob@example.com</code>.
 </p>
 <p>For existing files, you would grant access to
    <code>bob@example.com</code> and save the changes to the Virtru
    Platform.
 </p>
 <pre class="cplusplus"><code>Policy policy;
 policy.shareWithUsers({&quot;bob@example.com&quot;});
 
 client.updatePolicyForFile(policy, &quot;sensitive.docx.tdf.html&quot;);</code></pre>
 <p>Now, <code>bob@example.com</code> should be able to view your
    sensitive data in Secure Reader (anywhere) or via the SDK decrypt call
    (in your apps).
 </p>
 <p>When protecting new files, you can grant access to Bob or any number
    of users as part of encryption params:
 </p>
 <pre class="cplusplus"><code>Policy policy;
 policy.shareWithUsers({&quot;bob@example.com&quot;});
 EncryptFileParams params {&quot;sensitive.docx&quot;, &quot;sensitive.docx.tdf.html&quot;};
 params.setPolicy(policy);
 
 client.encryptFile(params);</code></pre>
 <h4 id="access-control-3">Access Control</h4>
 <p>No one can predict the future. Access controls let you change your
    mind about who has access and under what conditions.
 </p>
 <h5 id="grant-access-3">Grant Access</h5>
 <p>Let’s say Bob enters your circle of trust. If you grant him access,
    he can decrypt your sensitive data.
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.shareWithUsers({&quot;bob@example.com&quot;});
 
     client.updatePolicyForFile(policy, &quot;sensitive.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>You can also grant access before you encrypt:</p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.shareWithUsers({&quot;bob@example.com&quot;});
     EncryptFileParams params {&quot;sensitive.docx&quot;, &quot;sensitive.docx.tdf.html&quot;};
     params.setPolicy(policy);
 
     client.encryptFile(params);
     return EXIT_SUCCESS;
 }</code></pre>
 <h5 id="revoke-access-3">Revoke Access</h5>
 <p>Let’s say Bob leaves your circle of trust. It’d be great if he no
    longer had access to your sensitive data. Revoke will prevent Bob from
    decrypting your sensitive data:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.removeUsers({&quot;bob@example.com&quot;});
 
     client.updatePolicyForFile(policy, &quot;sensitive.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>You will still have access to your sensitive data.</p>
 <h5 id="revoke-all-access-3">Revoke All Access</h5>
 <p>Let’s say you landed a new job Alice. Well done! But your circle of
    trust becomes outdated. Rather than removing every Bob from accessing
    your sensitive data, you can remove everyone with revoke all:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
     client.revokeFile(&quot;sensitive.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>You will still have access to your sensitive data.</p>
 <h5 id="expire-access-3">Expire Access</h5>
 <p>Some things aren’t meant to last. Your landlord, Trent, shouldn’t
    have access to the sensitive data in your lease forever. Let’s make sure
    your sensitive data expires in a year when your lease does:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.expireInDays(365);
 
     client.updatePolicyForFile(policy, &quot;lease.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>You can also expire at a specific date and time:</p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.addExpiration(&quot;2020-05-24T16:12:41Z&quot;); // ISO-8601 Format
 
     client.updatePolicyForFile(policy, &quot;lease.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>Expiration prevents everyone else on the policy from decrypting after
    that time. You will still have access.
 </p>
 <p>Make the same expiration calls to update dates or times.</p>
 <p>If you’re feeling permissive, you can always remove expiration
    too:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.removeExpiration();
 
     client.updatePolicyForFile(policy, &quot;lease.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <h5 id="watermark-access-3">Watermark Access</h5>
 <p>Trust doesn’t have to be absolute. If you want Bob to access your
    sensitive data, but discourage him from sharing it, you can enable
    watermarking:
 </p>
 <pre class="cplusplus"><code>#include &lt;virtru_client.h&gt;
 #include &lt;cstdlib&gt;
 
 using namespace virtru;
 
 int main()
 {
     auto email = std::getenv(&quot;VIRTRU_SDK_EMAIL&quot;);
     auto appId = std::getenv(&quot;VIRTRU_SDK_APP_ID&quot;);
     if (email == nullptr || appId == nullptr) {
         std::cerr &lt;&lt; &quot;An environment variable is not set:\n- VIRTRU_SDK_EMAIL\n- VIRTRU_SDK_APP_ID&quot; &lt;&lt; std::endl;
         return EXIT_FAILURE;
     }
     Client client {email, appId};
 
     Policy policy;
     policy.enableWatermarking();
 
     client.updatePolicyForFile(policy, &quot;sensitive.docx.tdf.html&quot;);
     return EXIT_SUCCESS;
 }</code></pre>
 <p>This option only applies in Virtru’s Secure Reader, where Bob’s email
    address will always overlay the decrypted sensitive data.
 </p>
 <p>To disable watermarking:</p>
 <pre class="cplusplus"><code>Policy policy;
 policy.disableWatermarking();
 
 client.updatePolicyForFile(policy, &quot;sensitive.docx.tdf.html&quot;);</code></pre>
 </div><!-- End C++ SDK wrapper-->
 
 <h2 id="sample-apps">Sample Apps</h2>
 <p>We have built a few sample applications to get you up and running
    quickly. You may use these as starter projects, or look at their source
    code to learn about the SDK's features.
 </p>
 <h3 id="protect--track-app">Protect &amp; Track App</h3>
 <ul>
    <li>Protect your sensitive files and share them with anyone. Revoke any
       time. Apply expiration, watermark controls.
    </li>
    <li>Track the files as they are opened or re-shared.</li>
    <li>Built using Virtru's JavaScript SDK.</li>
 </ul>
 <blockquote>
    <p><a href="https://demos.developer.virtru.com/protect/">Try Sample
       App</a>
    </p>
 </blockquote>
 <blockquote>
    <p><a href="https://github.com/virtru/protect-and-track">View on
       GitHub</a>
    </p>
 </blockquote>
 <h3 id="encrypt--decrypt-app">Encrypt &amp; Decrypt App</h3>
 <ul>
    <li>Drag a file to encrypt; Drag an encrypted file to decrypt</li>
    <li>Apply Virtru controls on files.</li>
 </ul>
 <blockquote>
    <p><a href="https://demos.developer.virtru.com/dd/">Try Sample
       App</a>
    </p>
 </blockquote>
 <blockquote>
    <p><a href="https://github.com/virtru/encrypt-decrypt-demo/">View on
       GitHub</a>
    </p>
 </blockquote>
 <h3 id="encrypt--upload-a-file-to-s3">Encrypt &amp; Upload a File to
    S3
 </h3>
 <p><code>encrypt-and-upload-s3.js</code></p>
 <div class="sourceCode" id="cb132">
    <pre class="sourceCode javascript">
      <code class="sourceCode javascript">
         <span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;virtru-sdk&#39;</span>)<span class="op">;</span></span>
          <span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> AWS <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;aws-sdk&#39;</span>)<span class="op">;</span></span>
          <span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
          <span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example showing how to encrypt and write a file to S3.</span></span>
          <span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span></span>
          <span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"> * This example assumes you&#39;ve installed the aws-sdk module and set up your AWS</span></span>
          <span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"> * credentials file. For more information, see: https://github.com/aws-samples/aws-nodejs-sample</span></span>
          <span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co"> *</span></span>
          <span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example usage: </span></span>
          <span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co"> *   node sample.js your</span><span class="an">@email.com</span><span class="co"> $(cat ~/.virtru/appId) hello.txt my-s3-bucket</span></span>
          <span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"> *</span></span>
          <span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co"> * If your bucket is configured for static website hosting you&#39;ll be able to </span></span>
          <span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co"> * open up Secure Reader directly from the object link.</span></span>
          <span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co"> * (e.g., http://my-s3-bucket.s3-website-us-west-2.amazonaws.com/hello.txt.html)</span></span>
          <span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
          <span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">2</span>]<span class="op">;</span></span>
          <span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">3</span>]<span class="op">;</span></span>
          <span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> localFilename <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">4</span>]<span class="op">;</span></span>
          <span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> bucketName <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">5</span>]<span class="op">;</span></span>
          <span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize the Virtru and S3 clients.</span></span>
          <span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({email<span class="op">,</span> appId})<span class="op">;</span></span>
          <span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> s3 <span class="op">=</span> <span class="kw">new</span> AWS<span class="op">.</span><span class="fu">S3</span>()<span class="op">;</span></span>
          <span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="co">// Derive the object key to use by appending .html for easy browser support.</span></span>
          <span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> key <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>localFilename<span class="sc">}</span><span class="vs">.html`</span><span class="op">;</span></span>
          <span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
          <span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(localFilename)</span>
          <span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withDisplayFilename</span>(localFilename)</span>
          <span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a><span class="co">// The returned stream can be passed directly to s3.upload().</span></span>
          <span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">.</span><span class="fu">then</span>(ct <span class="kw">=&gt;</span></span>
          <span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a> s3<span class="op">.</span><span class="fu">upload</span>({<span class="dt">Body</span><span class="op">:</span> ct<span class="op">,</span> <span class="dt">Bucket</span><span class="op">:</span> bucketName<span class="op">,</span> <span class="dt">Key</span><span class="op">:</span> key<span class="op">,</span> <span class="dt">ContentType</span><span class="op">:</span> <span class="st">&#39;html/text&#39;</span>}<span class="op">,</span> onComplete))<span class="op">;</span></span>
          <span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">onComplete</span>(err<span class="op">,</span> data) {</span>
          <span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`</span><span class="sc">${</span>localFilename<span class="sc">}</span><span class="vs"> encrypted and uploaded to S3 as </span><span class="sc">${</span>key<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
          <span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>}</span>
        </code>
    </pre>
 </div>
 
 <h3 id="encrypt-all-files-in-a-directory">Encrypt All Files in a
    Directory
 </h3>
 <p><code>encrypt-dir.js</code></p>
 <div class="sourceCode" id="cb133">
    <pre class="sourceCode js">
      <code class="sourceCode javascript">
         <span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> Virtru <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;virtru-sdk&#39;</span>)<span class="op">;</span></span>
          <span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> fs <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;fs&#39;</span>)<span class="op">;</span></span>
          <span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
          <span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example showing how to encrypt a directory asynchronously.</span></span>
          <span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span></span>
          <span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"> * For this example we will use .zip format, which is more efficient </span></span>
          <span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co"> * and suitable for programmatic operations. Files with this format must</span></span>
          <span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co"> * be decrypted with the SDK.</span></span>
          <span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co"> *</span></span>
          <span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example usage: </span></span>
          <span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="co"> *   node sample.js your</span><span class="an">@email.com</span><span class="co"> $(cat ~/.virtru/appId) toEncrypt/ encrypted/</span></span>
          <span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
          <span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> email <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">2</span>]<span class="op">;</span></span>
          <span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> appId <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">3</span>]<span class="op">;</span></span>
          <span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> sourceDir <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">4</span>]<span class="op">;</span></span>
          <span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> destDir <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">argv</span>[<span class="dv">5</span>]<span class="op">;</span></span>
          <span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize the client and destination directory.</span></span>
          <span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> client <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">Client</span>({email<span class="op">,</span> appId})<span class="op">;</span></span>
          <span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>fs<span class="op">.</span><span class="fu">mkdirSync</span>(destDir)<span class="op">;</span></span>
          <span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="co">// For each file in the directory, encrypt using the helper function.</span></span>
          <span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>promises <span class="op">=</span> fs<span class="op">.</span><span class="fu">readdirSync</span>(sourceDir)<span class="op">.</span><span class="fu">map</span>(filename <span class="kw">=&gt;</span> <span class="fu">encryptOne</span>(filename))<span class="op">;</span></span>
          <span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co">// Wait for all operations to finish, then write a completion message.</span></span>
          <span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="bu">Promise</span><span class="op">.</span><span class="fu">all</span>(promises)<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> </span>
          <span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`All files in </span><span class="sc">${</span>sourceDir<span class="sc">}</span><span class="vs"> have been encrypted and written to </span><span class="sc">${</span>destDir<span class="sc">}</span><span class="vs">!`</span>))<span class="op">;</span></span>
          <span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a></span>
          <span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">encryptOne</span>(filename) {</span>
          <span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> encryptParams <span class="op">=</span> <span class="kw">new</span> Virtru<span class="op">.</span><span class="fu">EncryptParamsBuilder</span>()</span>
          <span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withFileSource</span>(<span class="vs">`</span><span class="sc">${</span>sourceDir<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>filename<span class="sc">}</span><span class="vs">`</span>)</span>
          <span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withZipFormat</span>() <span class="co">// Use the zip format.</span></span>
          <span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">build</span>()<span class="op">;</span></span>
          <span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a>  ct <span class="op">=</span> <span class="cf">await</span> client<span class="op">.</span><span class="fu">encrypt</span>(encryptParams)<span class="op">;</span></span>
          <span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Return the file write completion promise.</span></span>
          <span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ct<span class="op">.</span><span class="fu">toFile</span>(<span class="vs">`</span><span class="sc">${</span>destDir<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>filename<span class="sc">}</span><span class="vs">.tdf`</span>)<span class="op">;</span></span>
          <span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>}</span>
        </code>
    </pre>
 </div>
 <!-- architecture wrapper start-->
 <div class="section_wrapper">
 <h2 id="architecture">Architecture</h2>
 <h3 id="virtru-data-protection-platform">Virtru Data Protection
    Platform
 </h3>
 <p>With the Virtru Data Protection Platform, you can quickly integrate
    security and privacy for any data type—such as files, emails, structured
    or unstructured data—produced or consumed by your applications and
    connected devices. Whether you are building web or mobile applications,
    IoT or ML projects, sensitive data can be encrypted and protected even
    when disseminated into untrusted environments.
 </p>
 <p><img src=".screenshots/howitworks.png"
    alt="Virtru Platform Workflow. The Virtru Key Management services maintain key data and control access. Your App, the Client, stores per object keys and their access policys with it. Alice, here representing either a user or automated system, can use your application to take plaintext payloads, and use the Virtru SDK to produce TDF Ciphertext Objects that are held by the user with an access policy the user or the service can author. These can also be shared to the customer directly or with untrusted third party datastores. Bob may then use another app, or the same app, can then request those keys and policies from the Virtr key management service, and use it to decrypt the TDF ciphertext objects with the virtru SDK to extract the original plain text." /></p>
 <h3 id="creating-tdfs-with-the-virtru-sdk">Creating TDFs with the Virtru
    SDK
 </h3>
 <p>The Trusted Data Format (TDF) serves as the foundation for the Virtru
    Data Protection Platform, which simplifies data-level protection across
    systems and data types. Importantly, data owners maintain the ability to
    revoke, audit, and track the data even after it leaves their system. The
    Virtru SDK makes it easy to create TDFs and is interoperable across
    environments—including multi-cloud environments—so there are no vendor
    lock-in or infrastructure constraints.
 </p>
 <h4 id="step-1-protect">Step 1: Protect</h4>
 <p>In a few lines of code, developers can use the Virtru SDK to encrypt
    any data using the TDF format within an application or as it leaves
    their application. TDF cryptographically binds together:
 </p>
 <ul>
    <li>The payload (data to be encrypted)</li>
    <li>Encryption keys (per object)</li>
    <li>Access control policy</li>
 </ul>
 <p>Importantly, TDF and the Virtru SDK allow developers to configure the
    access policy on the data as they wish. This can be based on any range
    of criteria, such as users, group membership, time, etc.
 </p>
 <h4 id="step-2-send-protected-data-and-persist-protections">Step 2: Send
    Protected Data and Persist Protections
 </h4>
 <p>The data is now “self protecting” so you can send it anywhere. With
    the TDF protective wrapper traveling with the data, the data basically
    self protects by persisting encryption with the data wherever it
    goes.
 </p>
 <h4 id="step-3-audit-data-access">Step 3: Audit Data Access</h4>
 <p>Authenticated systems / individuals will be requesting access over
    time. With each access request, new entries appear on the audit log. For
    instance, if you allowed re-sharing, this will appear in the audit logs
    and Control Center. If unauthorized access is attempted, the audit logs
    will show that as well. The audit log provides persistent insights into
    who accesses, or attempts to access, the data - where, when, and over
    time.
 </p>
 <h4 id="step-4-evolve-access-policies-over-time">Step 4: Evolve Access
    Policies over Time
 </h4>
 <p>TDF and Virtru allow access policy changes over time, including by
    individuals, devices, or by geography, as your requirements change.
    Revocation is the most dramatic and impactful control, and visually
    demonstrates your full data control capabilities.
 </p>
 <h4 id="how-it-fits-together-architecture-diagram">How It Fits Together:
    Architecture Diagram
 </h4>
 <p>The architecture diagram below details how the SDKs, Key Management
    Infrastructure, Policy Management via Control Center and the Trusted
    Data Format (TDF) combine to help you customize security and privacy
    into your applications.
 </p>
 <p><img src=".screenshots/devplatform.png"
    alt="Virtru SDKs provide an application interface on top of our Digital Policy Management framework, which allows a service to set, enforce and report on enterprise policies and rules. The Management Dashboard is the front end to that service. This builds on top of three key blocks: Identity Federation, Key Access Server (KAS), and the Entity Attribute Server (EAS), which are building blocks of the Virtru Key Management Infrastructure. These all build on the Trusted Data Format (TDF), an Open Standard for Self-Protecting Data." /></p>
 <h4 id="the-trusted-data-format">The Trusted Data Format</h4>
 <p>As mentioned above, TDF provides the foundation for the entire Virtru
    Data Protection Platform. Created by Virtru Co-Founder and CTO, Will
    Ackerly, TDF is an open data format that provides a protective wrapper
    that travels with data. When invoked, Virtru SDKs ensure that all your
    objects (files, emails, etc) are encrypted, policy bound and persist as
    Trusted Data Format files. Once your objects are in TDF format, they can
    be shared or stored freely by your application. See our <a
       href="https://developer.virtru.com/docs/tdf-overview">TDF overview</a>
    to dive deeper into how it works.
 </p>
 <h4 id="virtru-sdks">Virtru SDKs</h4>
 <p>The Virtru SDK helps developers create TDFs within existing systems
    so organizations can reap the benefits of data protection and secure
    sharing. The Virtru SDK facilitates key management and access policies,
    including multiple access policies within specific files and retrieving
    user entitlements through streamlined communication with the policy
    server. Policy management is no longer the enemy but becomes simplified
    and evolves as access privileges evolve over time. Users can apply
    multiple classifications and access policies within a specific file,
    ensuring recipients can only view the portions that adhere to their
    access privileges.
 </p>
 <p><a href="https://developer.virtru.com/docs/sdk">Virtru's client
    SDKs</a> are embedded into your applications and do all the heavy
    lifting. They expose simple encryption and decryption interfaces to
    integrate security and privacy into your applications. The Virtru SDK is
    currently available in <a
       href="https://developer.virtru.com/docs/getting-started-js">Javascript</a>,
    <a href="https://developer.virtru.com/docs/getting-started-cpp">C++</a>,
    and <a
       href="https://developer.virtru.com/docs/getting-started-python">Python</a>,
    with additional languages coming soon. With minimal memory footprint,
    Virtru's SDKs are extremely scalable and won’t slow you down.
 </p>
 <h4 id="digital-policy-management-via-control-center">Digital Policy
    Management via Control Center
 </h4>
 <p>Virtru Control Center is an administrative dashboard that allows
    admins to set, enforce, audit and revoke all key access requests, and
    thus all data requests. Admins also use Control Center to define
    policies, manage users and revoke access.
 </p>
 <h4 id="virtru-key-management-infrastructure">Virtru Key Management
    Infrastructure
 </h4>
 <p>Virtru SDKs use Virtru's Key Management Infrastructure by default.
    Virtru's Key Management Infrastructure is based on Attribute-Based
    Access Controls (ABAC) and contains services necessary to host, secure,
    and control the access of the encryption keys. The Virtru Key and Policy
    Management Infrastructure stores and retrieves keys as well as the
    policies associated with the keys. This highly scalable and secure
    infrastructure acts as a backend for KAS.
 </p>
 <h5 id="key-access-server-kas-and-management-infrastructure">Key Access
    Server (KAS) and Management Infrastructure
 </h5>
 <p>The KAS acts as a Policy Decision Point (PDP). KAS decides whether an
    entity has the privilege to decrypt an object—like a file or email—or
    not. KAS makes this decision based on both an object’s access
    requirements as well as user privileges. If the user meets the access
    requirements, the decryption key is returned to the client. If not,
    access is denied.
 </p>
 <h5 id="entity-attribute-server-eas">Entity Attribute Server (EAS)</h5>
 <p>EAS provides Identity Management services and returns the attributes
    associated with an authenticated user. These attributes are used by KAS
    to make key access decisions. EAS supports Federated Identities, thus
    ensuring that customers can apply their pre-existing identities (and
    attributes).
 </p>
 <h5 id="identity-federation">Identity Federation</h5>
 <p>Virtru SDKs integrate existing identity standards such as OpenId,
    OAuth, and SAML, for user authentication. There is no need to recreate
    identity standards, expediting authentication and allowing you to work
    within your preferred identity standard. Our federated identity
    management simplifies authentication while maintaining the granular
    access controls to optimize security and privacy and prevent
    unauthorized data access.
 </p>
 <h3 id="security-model">Security Model</h3>
 <p>By creating a security model focused on the data, the Virtru Data
    Protection Platform disrupts the decades-old network security paradigm
    to give data owners greater control. A combination of crypto, policy,
    and access management features provide robust protection that travels
    with data regardless of platform or system.
 </p>
 <h3 id="data-as-the-new-perimeter">Data as the New Perimeter</h3>
 <p>Done right, you’ll no longer need to trust the systems storing your
    data. With the Trusted Data Format (TDF) as the open format for
    data-level security protections, Virtru and TDF together enable a
    fundamental shift in security models. Instead of placing the numerous
    control requirements on any system storing your data, these same
    requirements are placed on the data so you can securely create or share
    data with specific access policies. Fundamentally, Virtru and the TDF
    together allow you to:
 </p>
 <ul>
    <li>Encrypt data to enforce policy.</li>
    <li>Let your data go anywhere.</li>
    <li>Grant or deny access inside and outside your environment.</li>
    <li>Audit access over time.</li>
    <li>Change policy as needed after dissemination.</li>
 </ul>
 <p>Data remains protected not only within corporate sanctioned
    applications, but also as it travels across the range of platforms and
    services, including cloud-based apps and external partners.
 </p>
 <p><img src=".screenshots/datacentricsecurity.png"
    alt="Corporate Sanction Applications can use data in TDF form. This allows data to remain protected whereever it is shared; object-level protections enable persistent access control and monitoring. Thus they can flow out of the application to dropbox, then through services to other users, or through slack, email with exhange, or document services such as Office 365." /></p>
 <blockquote>
    <p>Data in and out of an organization</p>
 </blockquote>
 <h3 id="descriptive-crypto-agile-and-quantum-ready">Descriptive, Crypto
    Agile, and Quantum-Ready
 </h3>
 <p>Every object explicitly declares HOW it was encrypted, with what
    algorithms, key sizes, and modes. This enables maximum interoperability
    and future-proofing, to allow the application of the strongest crypto
    standards at any given time. As crypto standards evolve, it is easy to
    update and replace them without disrupting the underlying security
    model.
 </p>
 <h4 id="payload-encryption">Payload Encryption</h4>
 <p>To protect confidentiality and integrity of data wherever it goes,
    TDF supports encryption of any size and type of payload (see <a
       href="https://developer.virtru.com/docs/tdf-overview">TDF Overview</a>
    for links to how the schema supports all scenarios) with support and use
    of the strongest encryption standards available.
 </p>
 <h4 id="symmetric-key-payload-encryption">Symmetric Key Payload
    Encryption
 </h4>
 <p>Virtru apps and SDKs today implement the following symmetric
    algorithm and modes:
 </p>
 <ul>
    <li>AES-256-GCM (256-bit key Advanced Encryption Standard in Galois
       Counter Mode) (default)
    </li>
    <li>AES-256-CBC (256-bit key Advanced Encryption Standard in Cipher
       Block Chain) (deprecated)
    </li>
 </ul>
 <p>Note: CBC is recommended for use only to read previously encrypted
    TDF objects.
 </p>
 <h4 id="asymmetric-wrapping-of-data-encryption-keys">Asymmetric Wrapping
    of Data Encryption Keys
 </h4>
 <p>Virtru apps and SDK universally implement RSA 2048 by default for
    maximum interoperability. Elliptic Curve Cryptography has been
    implemented, but deployed today in a limited fashion. If you have an
    interest in ECC-enabled TDF please reach out to our devs at <a
       href="mailto:developers@virtru.com">developers@virtru.com</a>. We’d love
    to work with you.
 </p>
 <h4 id="payload-integrity-for-any-object-size">Payload Integrity for Any
    Object Size
 </h4>
 <p>The latest TDF allows for the inclusion of explicit data integrity
    metadata. This is designed in particular to support:
 </p>
 <ul>
    <li>Very large file encryption and decryption: segmentInfo can contain
       encryption information for parts of files, enabling large files to be
       encrypted in smaller chunks, with encryption metadata (including
       integrity) of each chunk being stored in this element. A parent hash
       strategy against the whole ensures that no segment can be removed or
       re-ordered.
    </li>
    <li>Streaming data integrity: similar to large files, per segment
       validation allows only some of a given file to be downloaded and still
       be able to validate its integrity. This is crucial for performant
       viewing of streamed and/or large content where integrity is
       required.
    </li>
 </ul>
 <h3 id="let-your-data-go-anywhere">Let Your Data Go Anywhere</h3>
 <p>Track and evolve policies over time with granular access privileges
    and audit features, even after data dissemination.
 </p>
 <h4 id="access-control-policy--object-level-assertions">Access Control
    Policy &amp; Object-Level Assertions
 </h4>
 <p>Access control policy can be either embedded within a TDF as a
    cryptographically-bound object independent of payload or remotely
    managed. This can take the form of a TDF Assertion, with or without
    payload encryption. For encrypted payloads, policy can be
    cryptographically bond to the payload key via HMAC (see <a
       href="https://github.com/virtru/tdf3-spec">TDF spec </a>for
    details).
 </p>
 <p>Policies can be created in almost any fashion via a flexible
    Attribute-Based Access Control model. This can include the use of data
    attributes like classification or authorities, or basic access control
    lists like email addresses. Please see <a
       href="https://developer.virtru.com/docs/sdk">our SDK documentation</a>
    for more details.
 </p>
 <h4 id="audit-access-over-time">Audit Access Over Time</h4>
 <p>TDF protocol and infrastructure enables logging every key request for
    reliable auditing and tracking of access requests. This provides an
    unprecedented ability to track who accesses what data, at what time, and
    where. The data audit can not only track by person, but also by location
    and device. Data can be bound to groups and individuals as well as to
    devices and locations.
 </p>
 <h4 id="change-policy-as-needed-after-dissemination">Change Policy as
    Needed After Dissemination
 </h4>
 <p>The capabilities above can be composed, in particular when using
    Virtru SAAS key management, to give you the ultimate ability to evolve
    policy over time in sync with changing needs or based on observed
    threats in particular as surfaced by audit.
 </p>
 </div><!-- End Section wrapper-->

 <div class="section_wrapper">
 <h2 id="glossary">Glossary</h2>
 <h3 id="acm">ACM</h3>
 <p>See “Access Control Manager.”</p>
 <h3 id="access-control-manager">Access Control Manager</h3>
 <p>Central component of SaaS key management infrastructure that hosts
    and manages keys, enforces policies for access controls, and brokers
    access to protected data via authentication and authorization. <em>Also
    see “Entity Attribute Service” and “Key Access Server.”</em>
 </p>
 <h3 id="active-policy">Active Policy</h3>
 <p>Any protected data interaction over a 30-day period via operations
    like encrypt, decrypt, access, or updates to protected data. <em>Also
    see “Policy.”</em>
 </p>
 <h3 id="appid-token-3">appId Token</h3>
 <p>An authentication token and associated email address that identify an
    entity to the Virtru Platform. Subject to expiration every 120 days. <a
       href="https://developer.virtru.com/docs/how-to-download-appid-token">How
    do I get an appId? </a>
 </p>
 <h3 id="domain-whitelisting">Domain Whitelisting</h3>
 <p>A process by which Virtru verifies a domain as a valid endpoint for
    use with the Virtru JavaScript SDK. <a
       href="https://developer.virtru.com/docs/how-to-add-your-site-to-virtru-whitelist">How
    do I whitelist my domain?</a>
 </p>
 <h3 id="eas">EAS</h3>
 <p>See “Entity Attribute Service”</p>
 <h3 id="entity">Entity</h3>
 <p>A user trying to protect or access data. Not necessarily human (e.g.
    bots or devices). Identified by email address.
 </p>
 <h3 id="entity-attribute-service">Entity Attribute Service</h3>
 <p>Provides identity management services and asserts attributes owned by
    an entity.
 </p>
 <h3 id="hmac-token--secret">HMAC Token &amp; Secret</h3>
 <p>An authentication method that identifies a set of entities under one
    organization to the Virtru Platform. Not subject to expiration. <em>Also
    see “appId Token.”</em>
 </p>
 <h3 id="kas">KAS</h3>
 <p>See “Key Access Server.”</p>
 <h3 id="key-access-server">Key Access Server</h3>
 <p>Determines whether an entity has access to request decryption key or
    not.
 </p>
 <h3 id="owner">Owner</h3>
 <p>See “Policy Owner.”</p>
 <h3 id="policy">Policy</h3>
 <p>A way to control access to protected data throughout its lifecycle.
    <em>Also see “Active Policy” and “Policy Owner.”</em>
 </p>
 <h3 id="policy-owner">Policy Owner</h3>
 <p>The entity that owns the policy. Commonly the same entity that
    created the policy by protecting sensitive data. <em>Also see
    “Policy.”</em>
 </p>
 <h3 id="tdf-file-extension">.tdf File Extension</h3>
 <p>Data encrypted with a Virtru SDK in ZIP format. <em>Also see
    “.tdf.html File Extension” and “Trusted Data Format.”</em>
 </p>
 <h3 id="tdfhtml-file-extension">.tdf.html File Extension</h3>
 <p>Data encrypted with a Virtru SDK in HTML format. <em>Also see “.tdf
    File Extension” and “Trusted Data Format.”</em>
 </p>
 <h3 id="tdf">TDF</h3>
 <p>See “Trusted Data Format.”</p>
 <h3 id="trusted-data-format">Trusted Data Format</h3>
 <p>An open format for data-centric protection that binds encrypted data
    to policies and metadata ensuring that only the owner and authorized
    entities have access. <a href="https://github.com/virtru/tdf3-spec">Read
    the TDF3 spec.</a>
 </p>
 <h3 id="virtru-control-center">Virtru Control Center</h3>
 <p>A web-based administrative console for managing, tracking, and
    controlling data protection policies.
 </p>
 <h3 id="virtru-secure-reader">Virtru Secure Reader</h3>
 <p>A web-based Virtru product that allows users to authenticate,
    decrypt, and view protected data.
 </p>
 </div><!-- End Section Wrapper-->
 <!-- Start Section Wrapper-->
 <div class="section_wrapper">
 <h2 id="faqs">FAQs</h2>
 <h3 id="how-to-open-a-tdf">How to Open a TDF</h3>
 <p>Let's say someone you added to the policy got a <code>.html</code> or
    <code>.tdf</code> file. This is how they can open the file:
 </p>
 <h4 id="open-a-html-file">Open a .html file</h4>
 <ol type="1">
    <li>Drag and drop the <code>.html</code> file into a browser
       window.
    </li>
    <li>The file is automatically redirected to Virtru Secure Reader and
       file will be decrypted.
    </li>
    <li>If the redirect does not automatically take place, click on
       <code>View File in Virtru Secure Reader</code>.
    </li>
 </ol>
 <h4 id="open-a-tdf-file">Open a .tdf file</h4>
 <ol type="1">
    <li>Visit <a href="https://secure.virtru.com/secure-reader">Virtru
       Secure Reader.</a>
    </li>
    <li>Follow instructions to authenticate.</li>
    <li>Drag and drop the <code>.tdf</code> file into the browser tab and
       file will be decrypted.
    </li>
 </ol>
 <p>Alternatively, the authorized user can always decrypt the file <a
    href="https://developer.virtru.com/docs/how-to-decrypt-a-file">using the
    SDK</a>.
 </p>
 <h3 id="how-to-download-an-appid-token">How to Download an AppID
    Token
 </h3>
 <blockquote>
    <p><strong>Remember</strong> Please be sure to protect all credentials
       and secrets. Follow best practices.
    </p>
 </blockquote>
 <p>You can copy your AppId from <a
    href="https://virtru.com/dashboard">Virtru Control Center</a> by
    following these instructions:
 </p>
 <ol type="1">
    <li>
       <p>Login to <a href="https://virtru.com/dashboard">Virtru Control
          Center</a> using one of the supported authentication schemes.
       </p>
    </li>
    <li>
       <p>Under "Personal" section, click on "Settings"</p>
    </li>
    <li>
       <p>Toggle the switch to turn on the Developer Mode.</p>
    </li>
    <li>
       <p>Copy the AppId displayed.</p>
    </li>
 </ol>
 <p><img src=".screenshots/appidadmin.png"
    alt="Screen shot of the Developer Settings tab within the Virtru Organization Administion Dashboard" /></p>
 <blockquote>
    <p><em>How to disable your AppID?</em> Simply toggle the Developer Mode
       to OFF.
    </p>
 </blockquote>
 <h3 id="how-to-allowlist-your-site-with-virtru">How to Allowlist Your
    Site with Virtru
 </h3>
 <p>In order authenticate outside of your local environment or to use <a
    href="/docs/client-side-js-authentication#section-3-federation-using-google-o365-and-outlook">Federated
    Authentication schemes</a> on your site, you need to list your domain
    with Virtru. This will allow our team to verify your domain as a valid
    endpoint for Virtru SDKs.
 </p>
 <ol type="1">
    <li>
       <p>Login to the <a href="https://virtru.com/dashboard">Virtru
          Control Center</a>.
       </p>
    </li>
    <li>
       <p>Under the "Personal" section, click on "Settings".</p>
    </li>
    <li>
       <p>Turn on "Developer Mode" if it's not on already.</p>
    </li>
    <li>
       <p>In "Verify Domains" section, enter the domain you'd like to
          register.
       </p>
    </li>
    <li>
       <p>The Virtru Support team will receive the request and get back to
          you on the email address corresponding to your login in Step 1.
       </p>
    </li>
 </ol>
 <p><img src=".screenshots/devallow.png"
    alt="Screen shot of the Settings page within the Virtru Organization Administion Dashboard" /></p>
 <blockquote>
    <p>Problems onboarding your domain? Please reach out to <a
       href="mailto:developers@virtru.com?subject=Whitelisting%20request"><a
       href="mailto:developers@virtru.com">developers@virtru.com</a></a> if you
       need help getting your domain enabled with the Virtru SDK.
    </p>
 </blockquote>
 </div><!-- End section wrapper-->

 <!-- Other section which I am not sure has to be in that doc-->

 <h2 id="community">Community</h2>
 <h2 id="contact-us">Contact Us</h2>
 <p>At Virtru, we believe security and privacy applications should be
    community driven.
 </p>
 <h3 id="have-a-suggestion-or-need-help">Have a suggestion or need
    help?
 </h3>
 <blockquote>
    <p><a
       href="https://support.virtru.com/hc/en-us/requests/new?ticket_form_id=360001419954">Open
       a support ticket</a>
    </p>
 </blockquote>
 <h3 id="join-our-slack-community">Join our Slack community</h3>
 <p>Get your questions answered with Virtru's Developer Hub on Slack</p>
 <blockquote>
    <p><a
       href="https://docs.google.com/forms/d/e/1FAIpQLSfCx5tSl9hGQSZ-H-ZIzNw6uWIPN3_HSpMtYssKQ9jytj9yQQ/viewform">Join
       Virtru on Slack</a>
    </p>
 </blockquote>
 <h2 id="code-of-conduct">Code of Conduct</h2>
 <h3 id="introduction">Introduction</h3>
 <p>Our goal for the Virtru Developer Hub Community is to be inclusive to
    the largest number of contributors, with the most varied and diverse
    backgrounds possible. As such, we are committed to providing a friendly,
    safe and welcoming environment for all, regardless of gender, sexual
    orientation, ability, ethnicity, socioeconomic status, and religion (or
    lack thereof).
 </p>
 <p>This code of conduct outlines our expectations for all those who
    participate in our community, as well as the consequences for
    unacceptable behavior.
 </p>
 <p>We invite all those who participate in the Virtru Developer Hub
    Community to help us create safe and positive experiences for
    everyone.
 </p>
 <h3 id="expected-behavior">Expected Behavior</h3>
 <p>We expect all community members to:</p>
 <ul>
    <li>Be friendly and patient.</li>
    <li>Be welcoming.</li>
    <li>Be considerate.</li>
    <li>Be respectful.</li>
    <li>Be careful in the words that you choose.</li>
 </ul>
 <h3 id="unacceptable-behavior">Unacceptable Behavior</h3>
 <p>The following behaviors are considered harassment and are
    unacceptable within our community:
 </p>
 <ul>
    <li>Violence, threats of violence or violent language directed against
       another person.
    </li>
    <li>Sexist, racist, homophobic, transphobic, ableist or otherwise
       discriminatory jokes and language.
    </li>
    <li>Posting or displaying sexually explicit or violent material.</li>
    <li>Posting or threatening to post other people's personally identifying
       information ("doxing").
    </li>
    <li>Personal insults, particularly those related to gender, sexual
       orientation, race, religion, or disability.
    </li>
    <li>Inappropriate photography or recording.</li>
    <li>Unwelcome sexual attention including sexualized comments or
       jokes.
    </li>
    <li>Deliberate intimidation, stalking or following (online or in
       person).
    </li>
    <li>Advocating for, or encouraging, any of the above behavior.</li>
 </ul>
 <h3 id="consequences-of-unacceptable-behavior">Consequences of
    Unacceptable Behavior
 </h3>
 <p>Unacceptable behavior from any community member will not be
    tolerated. Anyone asked to stop unacceptable behavior is expected to
    comply immediately.
 </p>
 <p>If a community member engages in unacceptable behavior, the community
    organizers may take any action they deem appropriate, up to and
    including a temporary ban or permanent expulsion from the community
    without warning.
 </p>
 <h3 id="reporting-guidelines">Reporting Guidelines</h3>
 <p>If you are the subject of, or witness to any violations of this Code
    of Conduct, please notify us by email at developers at virtru dot
    com.
 </p>
 <p>If you feel you have been falsely or unfairly accused of violating
    this Code of Conduct, you should notify developers at virtru dot com for
    review.
 </p>
 <h3 id="license-and-attribution">License and attribution</h3>
 <p>This code of conduct is derived from the <a
    href="http://citizencodeofconduct.org/">Citizen Code of Conduct</a> and
    the <a href="https://www.djangoproject.com/conduct/">Django Code of
    Conduct</a> under a <a
       href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons
    Attribution-ShareAlike license</a>.
 </p>
 <h2 id="responsible-disclosure">Responsible Disclosure</h2>
 <h3 id="virtru-responsible-disclosure-policy">Virtru Responsible
    Disclosure Policy
 </h3>
 <p>Virtru considers trust and the protection of our customers' data as a
    highest priority. Therefore, Virtru takes the security of our systems
    extremely seriously.
 </p>
 <p>We acknowledge the valuable role that independent security
    researchers play in security and, as a result, we encourage responsible
    reporting of any vulnerabilities that may be found in our site or
    applications. Virtru is committed to working with security researchers
    to verify and address any potential vulnerabilities that are reported to
    us in accordance with this responsible disclosure policy.
 </p>
 <h4 id="reporting-a-potential-security-vulnerability">Reporting a
    Potential Security Vulnerability
 </h4>
 <p>For the security of our users and service, we ask that you do not
    share details of the suspected vulnerability publicly or with any third
    party.
 </p>
 <p>Please report the details of any suspected or detected
    vulnerabilities with Virtru by emailing <a
       href="mailto:developers@virtru.com?subject:Responsible%20Disclosure"><a
       href="mailto:developers@virtru.com">developers@virtru.com</a></a>,
    including the following information:
 </p>
 <ul>
    <li>Vulnerability details with information to allow us to efficiently
       reproduce your steps and validate the vulnerability.
    </li>
    <li>Your information if you would like to be recognized on our Hall of
       Fame.
    </li>
 </ul>
 <h4 id="prohibited-actions">Prohibited Actions</h4>
 <p>While we encourage you to discover and report to us any
    vulnerabilities you find in a responsible manner, the following conduct
    is prohibited:
 </p>
 <ul>
    <li>Performing actions that may negatively affect Virtru or its users
       (e.g. Spam, Brute Force, Denial of Service, etc).
    </li>
    <li>Accessing, or attempting to access, data or information that does
       not belong to you.
    </li>
    <li>Destroying or corrupting, or attempting to destroy or corrupt, data
       or information that does not belong to you.
    </li>
    <li>Social engineering any Virtru service desk or personnel.</li>
    <li>Violating any laws or breaching any agreements in order to discover
       vulnerabilities.
    </li>
 </ul>
 <h4 id="our-commitment-to-researchers">Our Commitment to
    Researchers
 </h4>
 <p>If you responsibly report a vulnerability in accordance with this
    policy, we will:
 </p>
 <ul>
    <li>Promptly respond to acknowledge the receipt of your report.</li>
    <li>Provide an estimated timeframe for addressing the
       vulnerability.
    </li>
    <li>Notify you when the vulnerability has been remediated.</li>
 </ul>
 <h4 id="contributor-hall-of-fame">Contributor Hall of Fame</h4>
 <p>Virtru greatly appreciates anyone who has contributed to the security
    of our users by responsibly disclosing vulnerabilities to us. Thank you
    for your efforts!
 </p>
 <h2 id="about-virtru">About Virtru</h2>
 <p><a href="https://www.virtru.com/">Virtru</a> was founded on the core
    belief that privacy-preserving data protection is both a fundamental
    right and a force multiplier for organizations. Building an open,
    collaborative community is core to making this vision a reality.
 </p>
 <p>The Virtru Developer Hub aims to make privacy-preserving data
    protection accessible and impactful by providing developers with
    turn-key, easy-to-integrate SDK, APIs, and key management.
 </p>
 <h3 id="operating-at-the-intersection-of-security-and-privacy">Operating
    at the Intersection of Security and Privacy
 </h3>
 <p>Security compromises are increasingly privacy compromises, with a
    growing overlap in the area of unauthorized data access. At Virtru, we
    operate at this nexus of security and privacy to ensure our customers
    can reap the benefits of protecting against unauthorized data access
    while fostering data sharing and collaboration.
 </p>
 <p><img src=".screenshots/intersection.png"
    alt="Virtru: at the intersection of Privacy and Security" /></p>
 <p>Data protection strategies traditionally focus on locking down data,
    which comes at a significant cost; organizations fail to reap the
    benefits of collaboration and data sharing. Modern data protection
    requires protecting against unauthorized data access - including through
    compromise, unauthorized third-party sharing, or misconfigured servers
    and databases - while simultaneously securely sharing and collaborating
    internally and externally to achieve mission objectives.
 </p>
 <p>By focusing on the intersection of privacy and security,
    organizations can gain a competitive advantage and garner new insights
    and innovations through data sharing while advancing both security and
    privacy. The Virtru Data Protection Platform helps organizations succeed
    at this intersection of security and privacy by providing flexible and
    persistent data protection that travels with the data to promote secure
    data sharing and collaboration.
 </p>
 <p>Read our “Succeeding at the Intersection of Security and Privacy”
    white paper at IAPP:
 </p>
 <blockquote>
    <p><a
       href="https://iapp.org/resources/article/white-paper-succeeding-at-the-intersection-of-security-and-privacy/">Read
       Our Whitepaper</a>
    </p>
 </blockquote>
 <h3 id="the-virtru-difference">The Virtru Difference</h3>
 <p>With an open data protection ecosystem including the Trusted Data
    Format, SDK, and APIs, and a focus on ease of use for both developers
    and end users, Virtru helps organizations protect and share data across
    environments, applications, and devices.
 </p>
 <h4 id="secure-collaboration-across-environments">Secure Collaboration
    Across Environments
 </h4>
 <p>Gain confidence sharing and disseminating data, even in untrusted
    environments, thanks to TDF protections that travel with the data.
 </p>
 <h4 id="highly-scalable-security-model">Highly Scalable Security
    Model
 </h4>
 <p>Key management with Attribute-Based Access Controls helps developers
    build complex applications with fine-grained security settings while
    maintaining the flexibility to evolve key management policies over
    time.
 </p>
 <h4 id="provable-security-and-privacy">Provable Security and
    Privacy
 </h4>
 <p>Audit features provide demonstrable validation that security
    safeguards were implemented, helping adhere to current and future
    regulatory requirements.
 </p>
 <h4 id="open-and-customizable-development">Open and Customizable
    Development
 </h4>
 <p>Avoid proprietary black boxes and customize data protection solutions
    with Virtru SDK and APIs.
 </p>
 <h3 id="learn-more-about-the-virtru-ecosystem">Learn More about the
    Virtru Ecosystem
 </h3>
 <p>Virtru already helps thousands of organizations protect their most
    sensitive data. The Virtru SDK helps integrate Virtru protections into
    customizable applications. The Virtru Data Protection Platform offers
    additional enterprise benefits. Built-in integrations into GSuite,
    Office365, and many SaaS applications are available to scale your
    solutions in any environment through Virtru Hosted, Hybrid, and On-Prem
    deployment models.
 </p>
 <p>Learn more about the flexible deployment models and key management
    hosting options by contacting us.
 </p>
 <blockquote>
    <p><a href="https://www.virtru.com/contact-us/">Contact Us to Deploy
       &amp; Host</a>
    </p>
 </blockquote>
</div>
   </div>
 </body>
 </html>